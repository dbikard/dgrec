[
  {
    "objectID": "API/encoding.html",
    "href": "API/encoding.html",
    "title": "encoding",
    "section": "",
    "text": "source\n\nencode_tr_list\n\ndef encode_tr_list(\n    list_TRs:list, # A list of DNA sequences (strings) to encode.\n    feat:int=1\n):\n\nEncodes a list of TR sequences. If feat is 1, uses only the single feature model, if 2 uses the 2 features model.\n\nTR_list=['AACTTGCTAGTAAACACAGTGCAGCTAAAGTGCATTCTAATGGGGTACTAAATGTGTTGTTCCATCTGGG','CCAGAGGTTAGGATTATGAGTGTAGTGCGTATCACGTGGGTTGCAGATTAAACAGGTCGTGCCTCATTTA']\nencode_tr_list(TR_list,feat=2)\n\narray([[ -8.17911339, -15.36869621],\n       [-11.47970581, -13.57634544]])",
    "crumbs": [
      "API",
      "encoding"
    ]
  },
  {
    "objectID": "API/lstm.html",
    "href": "API/lstm.html",
    "title": "lstm",
    "section": "",
    "text": "source\n\ngenerate_sequences_oneTR\n\ndef generate_sequences_oneTR(\n    TR:str, # TR sequence\n    n:int=1000, # NUmber of VR to generate\n)-&gt;list: # List of `n` generated VR sequences.\n\nGenerate multiple VR sequences from a single TR sequence.\n\nsource\n\n\ngenerate_sequences\n\ndef generate_sequences(\n    X_seq:list, # list of TR sequences\n)-&gt;list: # List of generated VR sequences, in the same order as `X_seq`.\n\nGenerate VR sequences from a list of TR sequences.\nEach TR sequence produces exactly one VR sequence.\n\ngenerate_sequences_oneTR('CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACTGGGCCC',n=10)\n\n2026-01-29 14:31:02.870801: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:531] Loaded cuDNN version 8907\n\n\n1/1 ━━━━━━━━━━━━━━━━━━━━ 4s 4s/step\n\n\nGenerating sequence: 100%|██████████████████████| 70/70 [00:18&lt;00:00,  3.73it/s]\n\n\n['CGTAAACCGGACCTAGTTTAGTTCTTGGACCAAGGTACATATCCCCGTCACATAAGACGCGACTGGGCCC',\n 'CGTAGACCGGTCCTAGTTTGGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACCGGGCCC',\n 'CGTAAACCGGCCCTAGTTTAGTTCTTAGACCAAGGTACATAGACCCGTGCCATAAGACGCGACTGGGCCC',\n 'CGTAAACCGGGCCTAGTTTAGGTCTTAGTCCAAGGTACATGTCCCCGTTACATAAGGCGCGACTGGGCCC',\n 'CGTAAACCGGACCTAGTTTAGTTCTTAGCCCAGGGTACGTATACCCGTACCATAAGACGCGACTGGGCCC',\n 'CGTAAACCGGACCTAGTTTAGTTCTTAGACCAGGGTGCATGCCCCCGTTACATAGGACGCGACTGGGCCC',\n 'CGTTTACCGGACCTGGTTTAGTTCTTAGGCCAAGGTACTTATCCCCGTGGCATGGGACGCGACTGGGCCC',\n 'CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCACGTAACATAAGGCGCGACTGGGCCC',\n 'CGTAACCCGGACCTAGTTTAGTTCTTGGACCACGGGACATATCCCCGTAACATAAGCCGCGACTGGGCCC',\n 'CGTACCCCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACTGGGCCC']\n\n\n\nsource\n\n\nEvaluateTR_to_prot\n\ndef EvaluateTR_to_prot(\n    TR:str, # The TR sequence\n    NDGR:int=100, # Number of VR to generate for the protein logo\n    offset:int=0, # The offset for protein translation\n)-&gt;Counter: # Counts of translated protein sequences.\n\nEvaluate protein diversity accessible from a TR sequence via DGR.\nGenerates VR sequences from a single TR, translates them into proteins, and displays a protein sequence logo based on amino-acid frequencies.\n\nEvaluateTR_to_prot('CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACTGGGCCC')\n\n4/4 ━━━━━━━━━━━━━━━━━━━━ 3s 32ms/step\n\n\nGenerating sequence: 100%|██████████████████████| 70/70 [00:19&lt;00:00,  3.63it/s]\n/home/regnier/tf_env/lib/python3.10/site-packages/logomaker/src/error_handling.py:58: UserWarning:  Warning: Character '*' is not in color_dict. Using black.\n  warnings.warn(str(Error))\n\n\n&lt;Figure size 1200x400 with 0 Axes&gt;\n\n\n\n\n\n\n\n\n\nCounter({'RKPDLV*FLDQGTYPRNIRRDWA': 7,\n         'RKPDLV*FLDQGTYPRYIRRDWA': 5,\n         'RKPDLV*FLDQGPYPRNIRRDWA': 4,\n         'RKPDLV*FLAQGTYPRNIRRDWA': 3,\n         'RKPDLVSFLDQGTYPRNIRRDWA': 3,\n         'RKPDLV*FLDQGTYPRHIRRDWA': 3,\n         'RKPGLV*FLDQGTYPRNIRRDWA': 2,\n         'RKPDLV*FLDQGTYPRSIRRDWA': 2,\n         'RKPDLV*FLDQGTSPRNIRRDWA': 2,\n         'RIPDLV*FLDQGAYPRSVRRDWA': 1,\n         'RKPDLV*FFDHGTYPRNIRRDWA': 1,\n         'RKPALV*FLDQGTYPRNIRRDWA': 1,\n         'RKPDLV*FLAQGPYPRSLRRDWA': 1,\n         'RKPDLVSFLDQCTYPRNIRRDWA': 1,\n         'RVPVLV*FLDQGTYPRNIRRDWA': 1,\n         'RKPDLV*FFDQGTYPRNIRRDWA': 1,\n         'RKPDLV*FLALGTYPRDIRRDWA': 1,\n         'RKPALV*FLAQGTCPRYMRRDWA': 1,\n         'RKPDLV*FLDQGTYPRYISRDWA': 1,\n         'RIPDLV*FLAQGACPRNIGRAWA': 1,\n         'RIPALVWFFGQGSYPRNIGRAWA': 1,\n         'RKPVLVWFLDQGTSPRYIRRDWA': 1,\n         'RKPDLV*FLAQGAYPRIIGRDWA': 1,\n         'RKPDLV*FLGQGTYPRNMGRDWA': 1,\n         'RKPGLVEFLAQGAYPRYIRRDWA': 1,\n         'RKPDLV*FLAQGACPRNIRRDWA': 1,\n         'RLPALV*FLDQGTYPRYIRRDWA': 1,\n         'RSPDLV*FLDRGAYPRNLRRDWA': 1,\n         'RKPDLV*FLDQGTFPRYIRRDWA': 1,\n         'RKPDLV*FLDQGTCPRYISRDWA': 1,\n         'RKPVLV*FLDQGTYPRNIRRDWA': 1,\n         'RKPVLVSFLDQGTYPRNIRRDWA': 1,\n         'RKPDLV*FLDQGTGPRYIRRDWA': 1,\n         'RNPDLV*FLDQGTCPRNIRRDWA': 1,\n         'RKPDLVWVLDQGTCPRNIRRDWA': 1,\n         'RKPDLV*FLAHGTYPRNIRRDWA': 1,\n         'RIPDLV*FLDQGTYPRNIRRDWA': 1,\n         'RKPDLV*FLDQGTYPRNMGRDWA': 1,\n         'RKPDLV*FLDQGTCHRSIRRDWA': 1,\n         'RKPDLV*FLDQGTFPRNIRRDWA': 1,\n         'RKPDLV*FLDQGAYPRFIRRDWA': 1,\n         'RKPDLV*FLVQGAYPRCMRRDWA': 1,\n         'RKPDLV*FLDQGAYPRGLRRDWA': 1,\n         'RKPDLVSFLDQGTYPRYIRRDWA': 1,\n         'RKPDLV*FLDQGAYPRGIRRAWA': 1,\n         'RKPDLA*FLDRGPWPRDIRRDWA': 1,\n         'RKPDLV*FFDQGSYPRNIRRDWA': 1,\n         'RKPDLVWFLAQGAYPRYI*RDWA': 1,\n         'RKPDLV*FLDQGTYPRNIGRDWA': 1,\n         'RNPDLV*FLDQVTWPRSVRRDWA': 1,\n         'RIPDLV*FLDQGTSPRDIRRDWA': 1,\n         'RKPDLV*FLVQGACPRSIRRDWA': 1,\n         'RLPDLV*FLDQGACPRSVRRDWA': 1,\n         'RFPVLV*FFAQGACPRYIRRDWA': 1,\n         'RKPDLV*VFAQGAYPRYIRRDWA': 1,\n         'RKPVLV*FLDQGTSPRTMRRDWA': 1,\n         'RKPALV*FLAQGPYPRNIRRDWA': 1,\n         'RKPDLV*FLDPGTYPRYIRRDWA': 1,\n         'RKPDLV*FLDHGTYPRNIRRDWA': 1,\n         'RKPDLV*FLAQGTYPRSIRRDWA': 1,\n         'RKPDLV*FLAQGTCPRSIRRDWA': 1,\n         'RKPDLV*FLDQGTYPRHLRRDWA': 1,\n         'RKPALV*FLDQGSWPRYIRRDWA': 1,\n         'RKPDLV*FLAQGTYPRFIRRDWA': 1,\n         'RKPALV*FLDRGTYPRGIRRDWA': 1,\n         'RKPDLVWFLVRGAYPRDVRRDWA': 1,\n         'RKPDLV*FLDQGTFPRYISRDSA': 1,\n         'RKPDLV*FLAPGTYPRNIRRAWA': 1,\n         'RLPVLV*FLARGTYPRGIRRDWA': 1,\n         'RKPALVWFLDQGPYPRLIRRDWA': 1,\n         'RKPALV*FLAQGTYPRNIRRDWA': 1,\n         'RKPVLVWFLDQGTYPRNIRRDWA': 1,\n         'RKPDLV*FLALGTYPRNIRRDWA': 1,\n         'RKPGLV*FLDQGTWPRSIRRDWA': 1,\n         'RQPDLVSFLDQGTYPRNIRRDWA': 1,\n         'RKPDLV*FLDRGPCPRGIRRDWA': 1,\n         'RSPDLV*FLDQGTYPRNIRRDWA': 1,\n         'RKPDLV*FLAQGSYPRNIRRDWA': 1})\n\n\n\nsource\n\n\noptimize_sequence_display_proteins\n\ndef optimize_sequence_display_proteins(\n    original_seq:str, # Original DNA sequence to optimize.\n    frame_offset:int=0, # Reading-frame offset (0, 1, or 2) used when grouping codons.\n    CHANGES:int=6, # Maximum number of codon substitutions allowed.\n    freq_min:float=0.2, # Lowest usage frequency acceptable.\n    N:int=1, # Number of putative TR to output.\n    forbidden_positions:list=[], # Nucleotide positions that must not be modified.\n    threshold:float=0.7, # Minimum required value for both `Score_TRSp` and `Score_TRSpAvd` to\naccept a sequence as optimal.\n    codon_usage:dict={'F': {'TTT': 0.57, 'TTC': 0.43}, 'L': {'TTA': 0.15, 'TTG': 0.12, 'CTT': 0.12, 'CTC': 0.1, 'CTA': 0.05, 'CTG': 0.46}, 'S': {'TCT': 0.11, 'TCC': 0.11, 'TCA': 0.15, 'TCG': 0.16, 'AGT': 0.14, 'AGC': 0.33}, 'Y': {'TAT': 0.53, 'TAC': 0.47}, '*': {'TAA': 0.64, 'TAG': 0.0, 'TGA': 0.36}, 'C': {'TGT': 0.42, 'TGC': 0.58}, 'W': {'TGG': 1.0}, 'P': {'CCT': 0.17, 'CCC': 0.13, 'CCA': 0.14, 'CCG': 0.55}, 'H': {'CAT': 0.55, 'CAC': 0.45}, 'Q': {'CAA': 0.3, 'CAG': 0.7}, 'R': {'CGT': 0.36, 'CGC': 0.44, 'CGA': 0.07, 'CGG': 0.07, 'AGA': 0.07, 'AGG': 0.0}, 'I': {'ATT': 0.58, 'ATC': 0.35, 'ATA': 0.07}, 'M': {'ATG': 1.0}, 'T': {'ACT': 0.16, 'ACC': 0.47, 'ACA': 0.13, 'ACG': 0.24}, 'N': {'AAT': 0.47, 'AAC': 0.53}, 'K': {'AAA': 0.73, 'AAG': 0.27}, 'V': {'GTT': 0.25, 'GTC': 0.18, 'GTA': 0.17, 'GTG': 0.4}, 'A': {'GCT': 0.11, 'GCC': 0.31, 'GCA': 0.2, 'GCG': 0.38}, 'D': {'GAT': 0.65, 'GAC': 0.35}, 'E': {'GAA': 0.7, 'GAG': 0.3}, 'G': {'GGT': 0.29, 'GGC': 0.46, 'GGA': 0.13, 'GGG': 0.12}}, # Codon usage table of E. Coli mapping amino acids to codons and frequencies.\n    NDGR:int=100, # Number of sequences to generate via the LSTM for sequence logo estimation. \n):\n\nOptimize a DNA sequence via synonymous codon substitutions and shows the sequence logo for each of the optimal sequences.\nThis function performs a beam-search–based optimization of a nucleotide sequence by iteratively proposing single-codon synonymous changes and evaluating them with the two scoring functions. The search stops early if a variant meets the specified score thresholds, otherwise the best Pareto- optimal solution is returned.\n\nseq = ''.join(np.random.choice(['A','T','C','G'], size=70))\nprint(seq)\n\noptimize_sequence_display_proteins(seq,N=5,CHANGES=6)\n\nTAGATGCCGATTCATTCTAGCTTCGACAACAGTCAGCGAAAACTCTACCCACAGTAAATATTTCAGCAAG\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 30ms/step\n\n\nGenerating sequence: 100%|██████████████████████| 70/70 [00:10&lt;00:00,  6.77it/s]\n/home/regnier/tf_env/lib/python3.10/site-packages/logomaker/src/error_handling.py:58: UserWarning:  Warning: Character '*' is not in color_dict. Using black.\n  warnings.warn(str(Error))\n\n\n&lt;Figure size 1200x400 with 0 Axes&gt;\n\n\n\n\n\n\n\n\n\n4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 23ms/step\n\n\nGenerating sequence: 100%|██████████████████████| 70/70 [00:16&lt;00:00,  4.25it/s]\n/home/regnier/tf_env/lib/python3.10/site-packages/logomaker/src/error_handling.py:58: UserWarning:  Warning: Character '*' is not in color_dict. Using black.\n  warnings.warn(str(Error))\n\n\n&lt;Figure size 1200x400 with 0 Axes&gt;\n\n\n\n\n\n\n\n\n\n4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 15ms/step\n\n\nGenerating sequence: 100%|██████████████████████| 70/70 [00:18&lt;00:00,  3.81it/s]\n/home/regnier/tf_env/lib/python3.10/site-packages/logomaker/src/error_handling.py:58: UserWarning:  Warning: Character '*' is not in color_dict. Using black.\n  warnings.warn(str(Error))\n\n\n&lt;Figure size 1200x400 with 0 Axes&gt;\n\n\n\n\n\n\n\n\n\n4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 35ms/step\n\n\nGenerating sequence: 100%|██████████████████████| 70/70 [00:10&lt;00:00,  6.84it/s]\n/home/regnier/tf_env/lib/python3.10/site-packages/logomaker/src/error_handling.py:58: UserWarning:  Warning: Character '*' is not in color_dict. Using black.\n  warnings.warn(str(Error))\n\n\n&lt;Figure size 1200x400 with 0 Axes&gt;\n\n\n\n\n\n\n\n\n\n4/4 ━━━━━━━━━━━━━━━━━━━━ 0s 31ms/step\n\n\nGenerating sequence: 100%|██████████████████████| 70/70 [00:25&lt;00:00,  2.80it/s]\n/home/regnier/tf_env/lib/python3.10/site-packages/logomaker/src/error_handling.py:58: UserWarning:  Warning: Character '*' is not in color_dict. Using black.\n  warnings.warn(str(Error))\n\n\n&lt;Figure size 1200x400 with 0 Axes&gt;\n\n\n\n\n\n\n\n\n\n[{'Original_Sequence': 'TAGATGCCGATTCATTCTAGCTTCGACAACAGTCAGCGAAAACTCTACCCACAGTAAATATTTCAGCAAG',\n  'New_Variant': 'TGAATGCCGATTCACTCTAGCTTCGACAACAGTCAACGAAAGCTCTACCCACAGTGAATTTTTCAACAAG',\n  'Score': 0.6663332499583072,\n  'Rank': 1,\n  'Score_TRSp': 0.74,\n  'Score_TRSpAvd': 0.6,\n  'Proteins': Counter({'*MPIHSSFDNSQRKLYPQ*IFQQ': 8,\n           '*MPVHSSFDNSQRKLYPQ*IFQQ': 5,\n           '*MPIHSSFDNSQRKLSPQ*IFQQ': 4,\n           '*MPIHSSFDNSQRELYPQ*IFQQ': 4,\n           '*MPIHSSFDNSQRKLYPQ*IFPQ': 3,\n           '*MPIHSSFANSQRKLYPQ*IFQQ': 3,\n           '*MPLHSSFDNSQRKLYPQ*IFQQ': 3,\n           '*MPIHSSFGNSQRKLYPQ*IFQQ': 3,\n           '*MPIHSSFDNSHRKLYPQ*IFQQ': 3,\n           '*MPIHSSFDTSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSQRKLYPQ*IFLQ': 2,\n           '*MPIHSSFDSSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSQRQLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSQRKLYPQ*IFHQ': 2,\n           '*MPIHSSFDNSQRRLYPQ*IFQQ': 2,\n           'CMPLHSSFDYSLRKLYPQ*IFQQ': 1,\n           '*MPIHSSFGNGRRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNGQRELYPQ*IFLQ': 1,\n           '*MPIHSSFANSLRELYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFQP': 1,\n           '*MPIPSSFDNSQRKLCHQ*IFQQ': 1,\n           '*MPIHSSFDYGLRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDHSQR*LYPQ*IFQQ': 1,\n           '*MPIHSSFDTSQRELYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*VFQQ': 1,\n           '*MPIQSSFVSSQRKLYPQ*IFQQ': 1,\n           '*VPIHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDCGLRELYPQ*IFQQ': 1,\n           '*MPIPSSFDSRQRKLYPP*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFQR': 1,\n           '*MPIHSSFGSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSLRELDPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPR*IFQQ': 1,\n           '*MPLHSSFDHSQRKLYPQ*IFQQ': 1,\n           'CMPIHSSFGGGQRKLSPQ*IFQQ': 1,\n           '*MPIHSSFDYGQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRELYPP*IFQQ': 1,\n           '*MPIPSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHYSFDNSQRQLYPQ*IFQR': 1,\n           '*MPIPSSFDSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFGSSQR*LSPQCVFQQ': 1,\n           '*MPIHSSFDKSQRKLYPR*VFQQ': 1,\n           '*MPFLSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFGSSHRKLFPQ*IFQQ': 1,\n           '*MPFHSSFANSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQCIFQQ': 1,\n           '*MPIHSSFDNSQRALYPQ*IFQQ': 1,\n           '*MPIHSSFDASQRELYPQ*IFQQ': 1,\n           '*MPIHSSFDYGQRGLSPQ*IFQQ': 1,\n           '*MPIHSSFDNSPRKLYPQ*IFQQ': 1,\n           '*VPIHSGFASSRRKLCPQ*IFQQ': 1,\n           '*MPIHSSFDYRQRKLYPQ*IFQQ': 1,\n           'WMPIHSGFDNSQRKLYPQ*IFQQ': 1,\n           '*MPFHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDAGQRKLYPQ*IFQQ': 1,\n           '*MPILSSFDDSQRKLYPQ*IFQQ': 1,\n           '*MPIHSGFGSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNRQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDASQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSHRQLYPQ*IFQQ': 1,\n           '*MPIHSSFDYSQRELYPQ*IFQQ': 1,\n           '*LPIHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDGSQRKLSPQ*IFQQ': 1,\n           '*MPIHSSFDNSLRKLYPQ*IFQQ': 1,\n           '*MPIHSSFVSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDSSRRKLSPQ*IFQQ': 1,\n           '*MPIHSRFDNSQRKLYPQ*IFQQ': 1})},\n {'Original_Sequence': 'TAGATGCCGATTCATTCTAGCTTCGACAACAGTCAGCGAAAACTCTACCCACAGTAAATATTTCAGCAAG',\n  'New_Variant': 'TGAATGCCGATTCACTCTAGCTTCGATAACAGTCAGCGAAAGCTCTACCCACAGTGAATTTTTCAACAAG',\n  'Score': 0.6607571414672716,\n  'Rank': 2,\n  'Score_TRSp': 0.74,\n  'Score_TRSpAvd': 0.59,\n  'Proteins': Counter({'*MPIHSSFDNSQRKLYPQ*IFQQ': 11,\n           '*MPIPSSFDNSQRKLYPQ*IFQQ': 5,\n           '*MPIHSSFDNSQRKLSPQ*IFQQ': 3,\n           '*MPIHSSFDNSQRKLYPQ*IFQH': 3,\n           '*MPLHSSFDNSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSQRKLYPQ*IFPQ': 2,\n           '*MPIHSSFDNSQRKLYPQ*IFHQ': 2,\n           '*MPIHSSFDNSQRKLYPP*IFQQ': 2,\n           '*MPIHSSFANSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSQRKLYPQ*IFQP': 2,\n           '*VPIHSSFDNSQRKLYPQ*IFQQ': 2,\n           '*MPVHSSFDNSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDTSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSRRKLYPQ*IFQP': 1,\n           '*VPIHSSFDNSQRKLYPQ*IFQH': 1,\n           '*MPIHSSFDRSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDYSQRKLYPQ*IFHQ': 1,\n           '*MPIHSSFDNSQRMLCPQ*IFQQ': 1,\n           '*MPIHSSFDDSQRELYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPR*IFQR': 1,\n           '*MPIHSSFDNSQRTLYPQ*IFQQ': 1,\n           '*MPIPSSFDSSQRKLYPQ*IFQQ': 1,\n           'WMPVLSSFDSSQRGLFPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLSPP*IFQQ': 1,\n           '*MPIRSSFDSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSRFDNSQRKLYPQ*ICPQ': 1,\n           '*MPIHSSFDYSQRKLDPQCIFQQ': 1,\n           '*VPIHSSFDDSQRKLAPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPR*IFQQ': 1,\n           '*MPIHSSFDKSQRKLYPQ*IFQH': 1,\n           '*MPIHSSFDNSQRRLYPQ*IFQQ': 1,\n           '*MPIHSSFDGSQRKLYPQ*IFQQ': 1,\n           '*LPIHSSFDNSQRTLYPQ*IFQQ': 1,\n           '*MPLHSSFDHSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDSSQRRLYPQ*IFQQ': 1,\n           '*MPIPSSFDGSQRELYPQ*IFQQ': 1,\n           '*MPIHSSFDYNRRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDTSQRTLYPQ*IFQQ': 1,\n           '*MPIHSSFDGSQRELYPQ*IFRQ': 1,\n           '*MPIHSSFDNSQRKL*PQCIFHQ': 1,\n           '*MPIHSSFDNSRRKLYPQ*IFQQ': 1,\n           'WLPIHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPFHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDYSQRKLYPQ*IFQQ': 1,\n           '*MPFHSSFDGSQRKLCPQ*IFQQ': 1,\n           '*VPVHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIRSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPILSSFGNSQRKLYPQ*IFQQ': 1,\n           'CMPIHSSFDNSQRKLYPQ*IFQQ': 1,\n           'WLPFRSSFDNSRRGLSPQWFFQQ': 1,\n           '*MPIHSSFDYSQR*LYPQ*IFQQ': 1,\n           '*MPILSSFDGGQRKLYPQ*IFQQ': 1,\n           '*MPVHSSFDDSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDVSRRRLYHQCIFQQ': 1,\n           '*MPIHSSFGLSQRKLSPQ*IFQQ': 1,\n           '*MPIHSSFDVSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFGNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSGFDYSQRKLYPQ*IFQQ': 1,\n           '*MPIHSGFDYSQRKLSPQ*IFQQ': 1,\n           '*MPIHSRFDNSQR*LYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFLQ': 1,\n           '*MPIHSSFDNSQRKLSPR*IFQQ': 1,\n           'WMPIHSSFDNSRRKLSPQWIFQQ': 1,\n           '*LPIHSSFDSSQRKLYPQ*IFQQ': 1,\n           '*MPIPSSFDNSQRQLYPQ*IFQQ': 1,\n           '*MPIHSSFDDSQRKLCPQ*IFQQ': 1,\n           '*MPIHSSFVNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFQR': 1,\n           '*MPIHSSFDSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRELSPQ*IFQQ': 1,\n           '*MPIHSSFGYSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFGNGQRKLSPQ*IFQQ': 1,\n           '*MPIHSSFDNGLRKLFPQ*IFQQ': 1})},\n {'Original_Sequence': 'TAGATGCCGATTCATTCTAGCTTCGACAACAGTCAGCGAAAACTCTACCCACAGTAAATATTTCAGCAAG',\n  'New_Variant': 'TGAATGCCGATTCACTCTAGCTTTGACAACAGTCAGCGAAAGCTCTACCCACAGTGAATTTTTCAACAAG',\n  'Score': 0.6607571414672716,\n  'Rank': 3,\n  'Score_TRSp': 0.74,\n  'Score_TRSpAvd': 0.59,\n  'Proteins': Counter({'*MPIHSSFDNSQRKLYPQ*IFQQ': 13,\n           '*MPIHSSFDSSQRKLYPQ*IFQQ': 6,\n           '*MPIHSSFDNSQRKLYPQ*IFHQ': 5,\n           '*VPIHSSFDNSQRKLYPQ*IFQQ': 5,\n           '*MPIPSSFDNSQRKLYPQ*IFQQ': 4,\n           '*MPVHSSFDNSQRKLYPQ*IFQQ': 3,\n           '*MPIHSSFDNSQRKLSPQ*IFQQ': 3,\n           '*MPIHSSFDDSQRKLYPQ*IFQQ': 3,\n           '*MPIHSSFDASQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDHSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDTSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSPRKLYPQ*IFQH': 1,\n           '*MPIHSSFDNSQRKLDPQWIFHQ': 1,\n           'CMPIHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIRSSFGVSQRKLYAQ*IFQQ': 1,\n           '*MPIPSSFGSSQRKLYPQ*IFQQ': 1,\n           '*MPVPSSFGDSQRKLSPQ*IFQQ': 1,\n           '*MPIRSSFDISQRELYPQ*IFQQ': 1,\n           '*MPIHSSFDSSRRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNRQRKLYPQ*IFQQ': 1,\n           '*MPIHSGFGNSQRKLYPQ*IFQQ': 1,\n           '*MPIPSGFDSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPP*IFQQ': 1,\n           '*MPIHSSFDPSQRKLYPQ*IFQQ': 1,\n           '*MPIPSSFASSQRKLYPQCIFQQ': 1,\n           '*MPIHSSFDNSPRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDSRQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLAPQ*IFQQ': 1,\n           '*LPIHSSFDNGQRKLYPQ*IFQQ': 1,\n           '*MPIPFSFDVSQRKLYPQ*IFQQ': 1,\n           '*MPVHSSFDNSQRELCPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRELSPQ*IFQQ': 1,\n           'CLPIHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRGLCPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFLQ': 1,\n           '*MPIHSSFGYSQRKLYPQ*IFQQ': 1,\n           '*MPFHSSFDYSQRKLYPQ*IFQQ': 1,\n           'CMPIHSSFDNSPRKLYPQ*IFQQ': 1,\n           '*MPIHSGFDGSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSRRKLYPQ*IFQQ': 1,\n           '*MPVHSSFDSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSGFDSSQRGLVPQ*IFQQ': 1,\n           '*MPIHSSFGNSRRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDYSQRKLYPQ*IFQQ': 1,\n           '*LPIHSSFDNSQRKLYPQ*IFPQ': 1,\n           '*MPLHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPLHSSFDNSHRKLYPQ*IFQQ': 1,\n           '*MPIHSSFVNSRRKLSPQ*IFQQ': 1,\n           '*VPIHSGFGDSQRKLYPQ*IFQQ': 1,\n           '*MPVRSSFDNSQRKLSPQ*IFQQ': 1,\n           '*MPIHSSFGNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSGFGYSQRELYPQ*IFQQ': 1,\n           '*MPIHSSFANSQR*LSPQ*IFQQ': 1,\n           '*MPILSSFDNGQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFVSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDYSPRKLYPQ*IFQQ': 1,\n           '*MPIHSSFVNSQRGLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*LFQQ': 1,\n           '*MPIHSSFDTSQRKLYPQ*IFQH': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFRQ': 1,\n           '*MPIHSSFDYSQRELYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFPQ': 1,\n           '*MPIHSSFRNSQRKLYPQ*IFQQ': 1})},\n {'Original_Sequence': 'TAGATGCCGATTCATTCTAGCTTCGACAACAGTCAGCGAAAACTCTACCCACAGTAAATATTTCAGCAAG',\n  'New_Variant': 'TGAATGCCGATTCACAGCAGCTTCGACAACAGTCAGCGAAAACTCTACCCGCAGTGAATCTTTCAACAAG',\n  'Score': 0.6587867636800242,\n  'Rank': 4,\n  'Score_TRSp': 0.7,\n  'Score_TRSpAvd': 0.62,\n  'Proteins': Counter({'*MPIHSSFDNSQRKLYPQ*IFQQ': 8,\n           '*MPIPSSFDNSQRKLYPQ*IFQQ': 4,\n           '*MPIRSSFDNSQRKLYPQ*IFQQ': 3,\n           '*MPIHSSFDNSPRKLYPQ*IFQQ': 3,\n           '*MPIHSSFDNSQRKLYPQ*IFHQ': 3,\n           '*MPIHSSFDNSQRNLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSQRTLYPQ*IFQQ': 2,\n           '*MPIHSSFANSQRKLYPQ*IFQQ': 2,\n           '*MPVHSSFDNSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSQRKLSPQ*IFQQ': 2,\n           '*MPIRSGFDLSQRKLYPQWIFKQ': 1,\n           '*MPIHSSFDNSQRTLSPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQWIFQQ': 1,\n           '*MPIHSSFDNSRRELCPQ*IFQQ': 1,\n           '*MPLHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSGFDDSQRKLYPQ*IFQQ': 1,\n           '*MPIHSRFDNSQRKLYPQ*LFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFPQ': 1,\n           '*VPIRSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIRSSFDNSQRSLSPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQCIFQH': 1,\n           '*VPIRSSFDSGRRILCPQ*IFKR': 1,\n           '*MPIPSSFDNSQRKLYPQ*IFQP': 1,\n           '*MPIHSSFDTSQRKLYPQ*IFHQ': 1,\n           '*MPIHGSFDYSQRKLYPQ*IFHQ': 1,\n           '*MPICSGFVNSQRKLYPQ*IFQQ': 1,\n           '*MPIRCSVGNSQRGLYPQ*IFQQ': 1,\n           '*MPIHSSFDTSQRKLYPQ*IFQH': 1,\n           '*MPIHSSFDSSPRKLYPQ*IFHQ': 1,\n           '*MPIHSSFGLSQRKLYPQ*IFQQ': 1,\n           '*MPLHRSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNGQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDTSQRKLYPQCIFQQ': 1,\n           'CMPIHSSFANSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFVNSQRKLYPQ*IFQQ': 1,\n           '*MPIRGSFDNSRRKLYPQ*IFQQ': 1,\n           '*MPIHSSFGASQRKLYPQ*IFQQ': 1,\n           '*MPLHSSFDNSQRKLSPQ*IFQQ': 1,\n           '*MPIHGSFDDSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSRRLLYPQ*IFQQ': 1,\n           '*MPIRSGFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFLQ': 1,\n           '*MPIHSGFDFSQRKLYPQ*IFQQ': 1,\n           '*MPIRSGFANSQRLLYPQ*IFQQ': 1,\n           '*MPIHSSFDSRQRILYPQ*IFQQ': 1,\n           '*MPIGSSFDCSQRKLYPQ*IFQQ': 1,\n           '*LPIHSSFDSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFGNSQRKLYPQ*IFQQ': 1,\n           'CMPIHRSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIRSGFDSSQRGLSPQ*IFQQ': 1,\n           '*MPIHSSFDISRRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDHSQRKLYPQ*IFQQ': 1,\n           '*MPILSSFDASQRKLSPQWIFQH': 1,\n           '*MPIFSSFDFSQRILYPQ*IFQQ': 1,\n           '*MPIHSSFDNRQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRQLYPQ*IFQQ': 1,\n           '*MPIHSSFDNGQRLLFPQ*IFQQ': 1,\n           '*MPIHSSFDSSQRGLYPQ*IFQQ': 1,\n           '*VPFHSSFDSSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFRQ': 1,\n           '*LPIHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDYRQRKLYPQ*IFQQ': 1,\n           '*MPIHRSFDNSQRKLYPQ*IFHQ': 1,\n           '*MPIHSSFEYSQRPLYPQ*LFQQ': 1,\n           'CMPIRSGFGDSQRKLYPQ*IFQQ': 1,\n           'CLPFRSSFDNGQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNGRRKLYPQ*IFQQ': 1,\n           '*MPIHSSFGNSQRELDPQ*IFQQ': 1,\n           '*MPIHGSFDNGQRALSPRCIFQQ': 1,\n           '*MPIHSSFDYSQRLLYPQ*IFQQ': 1,\n           '*MPVHSRFDNSQRELYSR*IFQQ': 1,\n           '*MPINSSFDNRQRKLYPQ*IFQQ': 1,\n           '*MPIHSGFDYSQRNLYPQ*IFQQ': 1,\n           '*MPIPSSFDNSQRSLSPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRRLYPQ*IFQQ': 1,\n           '*MPIRSSVDNSQRELYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFPH': 1,\n           '*MPIHSSFDFSQRLLYPQ*IFQQ': 1,\n           '*MPIHGSFDNSQRLLYPQ*IFQQ': 1})},\n {'Original_Sequence': 'TAGATGCCGATTCATTCTAGCTTCGACAACAGTCAGCGAAAACTCTACCCACAGTAAATATTTCAGCAAG',\n  'New_Variant': 'TGAATGCCGATTCACAGCAGCTTCGACAACAGTCAGCGAAAACTCTATCCACAGTGAATCTTTCAACAAG',\n  'Score': 0.6587867636800242,\n  'Rank': 5,\n  'Score_TRSp': 0.7,\n  'Score_TRSpAvd': 0.62,\n  'Proteins': Counter({'*MPIHSSFDNSQRKLYPQ*IFQQ': 7,\n           '*MPIHSSFDNRQRKLYPQ*IFQQ': 4,\n           '*MPIHSSFANSQRKLYPQ*IFQQ': 3,\n           '*MPIHSRFDNSQRKLYPQ*IFQQ': 3,\n           '*MPIHSSFDASQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDYSQRKLYPQ*IFQQ': 2,\n           '*MPLHSSFDNSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDTSQRKLYPQ*IFQQ': 2,\n           '*MPIRSSFDSSQRELYPQ*IFQQ': 2,\n           '*MPIHSSFDNSQRKLYPQ*IFQH': 2,\n           '*VPIHSSFDNSQRKLYPQ*IFQQ': 2,\n           '*MPVHSSFDNSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDNSQRKLYPP*IFQQ': 2,\n           '*MPIHSSFDHSQRKLYPQ*IFQQ': 2,\n           '*MPIHGSFDNSQRKLYPQ*IFQQ': 2,\n           '*MPIPSSFDNSQRKLYPQ*IFQQ': 2,\n           '*MPIHSSFDSSQRQLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQCIFQQ': 1,\n           '*VPIRSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRPLYPQ*IFQQ': 1,\n           '*LPLHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSGFGHRQRKLYPQ*IFQH': 1,\n           '*MPFHSSFGSSQRKLYPQ*IFQQ': 1,\n           '*MQIRSSFDTSQRKLYPQ*IFQQ': 1,\n           '*MPIHGSFDNSQRELYPQ*IFQQ': 1,\n           '*MPIPSSFDSSQRILYPQ*IFQQ': 1,\n           '*MPVLSSFVNSRRELYPQ*IFQQ': 1,\n           '*MPIHSSFDHSQRKLYPQCIFQQ': 1,\n           '*MPIHSSFDDSQRILGPQ*IFQQ': 1,\n           '*MPIHSSFDHSQRILYPQ*IFQQ': 1,\n           '*MPICSGFDDSQRKLYPQ*IFQQ': 1,\n           '*MPIPGSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFQP': 1,\n           '*MPIHSSFADSQRALYPQ*IFQQ': 1,\n           '*MPIRSSFVNSQRKLYPQ*IFQQ': 1,\n           '*MPIRSGFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDFSQR*LYPP*IFQQ': 1,\n           '*MPFHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFGSSQRKLYPQ*IFQQ': 1,\n           '*MPLHSGFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRELYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQCIFQH': 1,\n           '*MPIHSSFDNSQRQLYPQ*IFQQ': 1,\n           '*MPIHCGFVNSQRKLYPQ*IFQQ': 1,\n           '*LPIHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIRSSFDNSQRKLYPR*IFQQ': 1,\n           '*MPIHRSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIHSRFDNSQRKLYPQ*LFQQ': 1,\n           '*MPIHSGFDNSQRKLYPQ*IFQQ': 1,\n           '*MPLHSSFDNSQRKLYPQ*IFQR': 1,\n           '*MPIHSSFDHGQRKLYPQ*IFQQ': 1,\n           '*MPIRSSFDYSQRKLCPQ*IFQQ': 1,\n           '*MPIHGSFDASQRKLYPQ*IFQQ': 1,\n           '*MPCHCGFDVCQRKLYPQ*IFQQ': 1,\n           'WLPVHSSFDDGQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDHSQRNLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRKLYPQ*IFHQ': 1,\n           '*MPIHSSFDNSQRNLVPQ*IFKQ': 1,\n           '*MPIRSSFANSQRKLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSRRKLYPQ*IFQQ': 1,\n           'CMPVHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIRSSFDGSRRGLYPQ*IFQQ': 1,\n           '*MPIHSSFDNSQRILYPQ*IFQQ': 1,\n           'WLPIHSGFANSQRKLYPQ*IFQQ': 1,\n           '*MPLHSSFDNSQRKLCPQ*IFQQ': 1,\n           '*MPIPSSFDNSQRKLYPQ*ILQQ': 1,\n           '*MPFPGCFDCGPRKLYPQ*IFQQ': 1,\n           '*MPIRSSFDYSQRILYPR*IFQQ': 1,\n           '*MPIHSSFDGSQRKLFPQ*IFQQ': 1,\n           '*MPIHSSFDSSQRKLYPQ*IFQQ': 1,\n           '*MPIHGSFDNSQRKLYPQ*IFHQ': 1,\n           '*MPIHSSFDNSQRRLYPQ*IFQQ': 1,\n           '*MPVPGSFDNSQRLLYPQ*IFLQ': 1,\n           'CMPIHSSFDNSQRKLYPQ*IFQQ': 1,\n           '*MPIRSSFDSSQRKLYPQ*IFQQ': 1})}]\n\n\n\nsource\n\n\ncompute_likelihood\n\ndef compute_likelihood(\n    TR, # Reference/template sequence.\n    VR, # Variant sequence to score.\n): # Log-likelihood of VR given TR.\n\nCompute the log-likelihood of generating a variant sequence (VR) given a template/reference sequence (TR).\n\nTR='CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACTGGGCCC'\nVR='CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACTGGGCCC'\ncompute_likelihood(TR, VR)\n\n-4.534628229418797\n\n\n\nsource\n\n\ncompute_likelihood_list\n\ndef compute_likelihood_list(\n    TR_list, # Reference/template sequences.\n    VR_list, # Variant sequences.\n): # Log-likelihoods in the same order as input.\n\nCompute log-likelihoods for (TR, VR) pairs.\n\nTR_list=['CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACTGGGCCC']*2\nVR_list=['CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACTGGGCCC','CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTATCATAAGACGCGACTGGGCCC']\ncompute_likelihood_list(TR_list, VR_list)\n\n[-4.535991900941974, -8.759227246265613]\n\n\n\nsource\n\n\ncompute_likelihood_matrix\n\ndef compute_likelihood_matrix(\n    TR_list, # List of reference/template sequences.\n    VR_list, # List of variant sequences.\n    batch_size:int=64, # (Currently unused) Intended batch size for future optimization.\n): # Log-likelihood matrix of shape (len(TR_list), len(VR_list)).\n\nCompute a matrix of log-likelihoods where each entry (i, j) corresponds to the log-likelihood of generating VR_list[j] from TR_list[i].\nSequences with mismatched lengths are assigned -inf.\n\nTR_list=['CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACTGGGCCC','CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTATCATAAGACGCGACTGGGCCC']\nVR_list=['CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTAACATAAGACGCGACTGGGCCC','CGTAAACCGGACCTAGTTTAGTTCTTAGACCAAGGTACATATCCCCGTATCATAAGACGCGACTGGGCCC']\ncompute_likelihood_matrix(TR_list, VR_list)\n\n[[-4.535991900941974, -8.759227246265613],\n [-16.457268648590745, -5.387971227326468]]",
    "crumbs": [
      "API",
      "lstm"
    ]
  },
  {
    "objectID": "API/cli.html",
    "href": "API/cli.html",
    "title": "Command line interface",
    "section": "",
    "text": "def &lt;Group dgrec&gt;(\n    args:t.Any, kwargs:t.Any\n)-&gt;t.Any:\n\n\n\n\n\n\ndef &lt;Command genotypes&gt;(\n    args:t.Any, kwargs:t.Any\n)-&gt;t.Any:\n\n\n\n\n\n\ndef &lt;Command genotypes_paired&gt;(\n    args:t.Any, kwargs:t.Any\n)-&gt;t.Any:\n\nCalls dgrec.genotypes_paired.get_genotypes_paired",
    "crumbs": [
      "API",
      "Command line interface"
    ]
  },
  {
    "objectID": "API/plotting.html",
    "href": "API/plotting.html",
    "title": "plotting",
    "section": "",
    "text": "read_ref_file=\"sacB_ref.fasta\"\nref=next(SeqIO.parse(os.path.join(data_path,read_ref_file),\"fasta\"))\n\n\n#read_ref_file=\"\\\\sacB_ref.fasta\"\n#ref=next(SeqIO.parse(data_path+read_ref_file,'fasta'))\n\nref_seq=str(ref.seq)\ngen_list=parse_genotypes(os.path.join(data_path,\"sacB_genotypes.csv\"))\n\n\n# read_ref_file_paul='/home/prochett/DGRec/dgrec/example_data/sacB_ref.fasta'\n# ref_paul=next(SeqIO.parse(os.path.join(data_path,read_ref_file_paul),\"fasta\"))\n\n# ref_seq=str(ref_paul.seq)\n# gen_list=[]\n# with open(os.path.join(data_path,\"/home/prochett/DGRec/dgrec/example_data/sacB_genotypes.csv\"),\"r\") as handle: \n#     reader = csv.reader(handle, delimiter='\\t')\n#     for row in reader:\n#         gen_list.append((row[0],int(row[1])))\n\n\nsource\n\nplot_mutations\n\ndef plot_mutations(\n    gen_list:list, # list of genotypes. Each genotype is a tuple: (string representation of the genotype, number of molecules)\n    ref_seq:str, # reference sequence\n    sample_name:str=None, # sample name\n    plot_range:Union=None, # limits the plot to the specified range\n    TR_range:Union=None, # when specified creates a shaded box highlighting the position of the TR\n    ax:NoneType=None, # makes it possible to pass matplotlib axis to easily configure and save plots\n):\n\n\nsource\n\n\nplot_mutations_percentage\n\ndef plot_mutations_percentage(\n    gen_list:list, # list of genotypes. Each genotype is a tuple: (string representation of the genotype, number of molecules)\n    ref_seq:str, # reference sequence\n    sample_name:str=None, # sample name\n    plot_range:Union=None, # limits the plot to the specified range\n    TR_range:Union=None, # when specified creates a shaded box highlighting the position of the TR\n    rev_comp:bool=False,\n    ax:NoneType=None, # makes it possible to pass matplotlib axis to easily configure and save plots\n):\n\n\nax = plot_mutations(gen_list, ref_seq, sample_name=\"sacB\", plot_range=[0,139], TR_range=[50,119])\n\n\n\n\n\n\n\n\n\nax,mut_perc=plot_mutations_percentage(gen_list, ref_seq, sample_name=\"sacB\", plot_range=[0,139], TR_range=[50,119])\nplt.show\nprint(mut_perc)\n\n9.73\n\n\n\n\n\n\n\n\n\n\nax = plot_mutations_percentage(gen_list, ref_seq, sample_name=\"sacB\", plot_range=[0,139], TR_range=[20,89],rev_comp=True)\n\n\n\n\n\n\n\n\n\nsource\n\n\nplot_mutations_percentage_protein\n\ndef plot_mutations_percentage_protein(\n    aa_mut_list, # list of genotypes. Each genotype is a tuple: (string representation of the genotype, number of molecules)\n    ref_prot, # reference sequence\n    plot_range:NoneType=None, # limits the plot to the specified range\n    ax:NoneType=None\n):\n\n\naa_mut_list=get_aa_mut_list(gen_list,ref_seq,ori=-1) #the sacB gene is in reverse complement orientation compared to the VR so ori=-1 is needed\naa_mut_list[:10]\n\n[('', 43341),\n ('Y22H', 351),\n ('H15Q', 277),\n ('D19E', 246),\n ('L17P', 200),\n ('V23A', 162),\n ('S11P', 117),\n ('D25E', 113),\n ('D19E,Y22H', 75),\n ('T16P', 61)]\n\n\n\nref_prot=Seq(ref_seq).reverse_complement()[:-1].translate() #the sacB gene is in reverse complement orientation compared to the VR\n\nfig, ax = plt.subplots(1, 1, figsize=(20, 5))\nplot_mutations_percentage_protein(aa_mut_list, ref_prot, ax=ax)\nplt.show()\n\n/tmp/ipykernel_1816/3434536392.py:11: MatplotlibDeprecationWarning: The get_cmap function was deprecated in Matplotlib 3.7 and will be removed two minor releases later. Use ``matplotlib.colormaps[name]`` or ``matplotlib.colormaps.get_cmap(obj)`` instead.\n  colormap = cm.get_cmap(colormap_name, num_colors)",
    "crumbs": [
      "API",
      "plotting"
    ]
  },
  {
    "objectID": "API/genotypes.html",
    "href": "API/genotypes.html",
    "title": "genotypes",
    "section": "",
    "text": "source\n\nget_UMI_genotype\n\ndef get_UMI_genotype(\n    fastq_path:str, # path to the input fastq file\n    ref_seq:str, # sequence of the reference amplicon\n    umi_size:int=10, # number of nucleotides at the begining of the read that will be used as the UMI\n    ref_read_size:int=None, # number of nucleotides in the read expected to align to the ref_seq. If None the whole read will be used.\n    quality_threshold:int=30, # threshold value used to filter out reads of poor average quality\n    ignore_pos:list=[], # list of positions that are ignored in the genotype\n    kwargs:VAR_KEYWORD\n)-&gt;dict: # alignment parameters can be passed here (match, mismatch, gap_open, gap_extend)\n\nTakes as input a fastq_file of single read amplicon sequencing, and a reference amplicon sequence. Returns a dictionnary containing as keys UMIs and as values a Counter of all genotype strings read for that UMI.\n\nfastq_file=\"sacB_example.fastq.gz\"\nfastq_path=os.path.join(data_path,fastq_file)\n\nread_ref_file=\"sacB_ref.fasta\"\nref=next(SeqIO.parse(os.path.join(data_path,read_ref_file),\"fasta\"))\nref_seq=str(ref.seq)\n\nUMI_gencounter = get_UMI_genotype(fastq_path, ref_seq, ignore_pos=[0,1,2,138,139,140,141], gap_open=-5)\n\nfor umi in itertools.islice(UMI_gencounter,20):\n    print(umi, list(UMI_gencounter[umi].items()))\n\nn reads:    1000\nn_reads pass filter:    847\nn_reads aligned:    824\nNumber of UMIs: 814\nMedian number of reads per UMI: 1.0\nGCATANCTCA [('A61G,-63T,A76T,A91T', 1)]\nCGCATNTATA [('', 1)]\nCCTTGNAGTA [('', 1)]\nGGCGCNAGAA [('', 1)]\nTCTCTTGTGA [('', 1)]\nATTACAGAAT [('', 1)]\nCTTTTACTAT [('', 1)]\nTCAAAGTTTT [('A79T,A91G', 1)]\nTTAGCTCATA [('', 1)]\nTCATAATGTA [('', 1)]\nATGTGCGGAT [('', 1)]\nTGTGTTTATA [('', 1)]\nCCATACATCC [('', 1)]\nAGGGACGTTT [('A61G,A72G,A76G,A79T', 1)]\nGTGTAATAGC [('', 1)]\nATGTCTTTTA [('', 1)]\nTATCGGTAGT [('', 1)]\nGTCGGGGGGG [('', 1)]\nAAGTGGCACA [('', 1)]\nAATAGAACCT [('T108A,G127T,G132T', 1)]\n\n\n\nsource\n\n\ncorrect_UMI_genotypes\n\ndef correct_UMI_genotypes(\n    UMI_gencounter:dict, # the output of the get_UMI_genotype function\n    reads_per_umi_thr:int=2, # only assign a genotype to a UMI if we have reads_per_umi_thr reads for that genotype or more\n)-&gt;dict:\n\nKeeps only the genotype with the most reads for each UMI. Returns a dictionary with UMIs as keys and a tuple as value: (genotype string, number of reads)\n\ncorrect_UMI_genotypes(UMI_gencounter)\n\n{'CTCCGGGGAG': '',\n 'TGCTTGAGTG': 'A79T',\n 'AGGGCGGGCT': '',\n 'ATTTCTGTTT': '',\n 'TGGGGGGGCT': '',\n 'GATTGGTAGA': '',\n 'GAACTCTAGT': '',\n 'TAACTAATCG': 'A79G,A86G,A91G'}\n\n\n\nsource\n\n\ngenotype_UMI_counter\n\ndef genotype_UMI_counter(\n    UMI_gen_dict\n):\n\nTakes as input the output of correct_UMI_genotypes() and  returns a list of genotypes sorted by the number of UMIs detected corresponding that each genotype.\n\nUMI_gen_dict=correct_UMI_genotypes(UMI_gencounter, reads_per_umi_thr=0)\ngen_list = genotype_UMI_counter(UMI_gen_dict)\nfor g in gen_list[:20]:\n    print(f\"{g[1]}\\t{g[0]}\")\n\n675 \n3   C56A\n3   A76G\n3   A91G\n3   A91T\n2   C69T\n2   T122A\n2   A91C\n2   A105G\n2   C116A\n2   T60A\n2   T59A\n2   A68G\n2   T134A\n1   A61G,-63T,A76T,A91T\n1   A79T,A91G\n1   A61G,A72G,A76G,A79T\n1   T108A,G127T,G132T\n1   A48T,A86G\n1   A61T,A68T,A72G,A79C,A91G\n\n\n\nsource\n\n\nget_genotypes\n\ndef get_genotypes(\n    fastq_path:str, # path to the input fastq file\n    ref_seq:str, # sequence of the reference amplicon\n    umi_size:int=10, # number of nucleotides at the begining of the read that will be used as the UMI\n    ref_read_size:int=None, # number of nucleotides in the read expected to align to the ref_seq. If None the whole read will be used.\n    quality_threshold:int=30, # threshold value used to filter out reads of poor average quality\n    ignore_pos:list=[], # list of positions that are ignored in the genotype\n    reads_per_umi_thr:int=0, # minimum number of reads required to take a UMI into account. Using a number &gt;2 enables to perform error correction for UMIs with multiple reads.\n    save_umi_data:str=None, # path to the csv file where to save the details of the genotypes reads for each UMI. If None the data isn't saved.\n    kwargs:VAR_KEYWORD\n):\n\nPutting things together in a single wrapper function that takes the fastq as input and returns the list of genotypes.\n\nfastq_file=\"sacB_example.fastq.gz\"\nfastq_path=os.path.join(data_path,fastq_file)\nread_ref_file=\"sacB_ref.fasta\"\nref=next(SeqIO.parse(os.path.join(data_path,read_ref_file),\"fasta\"))\nref_seq=str(ref.seq)\ngen_list = get_genotypes(fastq_path, ref_seq, \n                         ignore_pos=[0,1,2,138,139,140,141],\n                         gap_open=-4, \n                         save_umi_data=\"test.csv\")\nfor g in gen_list[:20]:\n    print(f\"{g[1]}\\t{g[0]}\")\n\nn reads:    1000\nn_reads pass filter:    847\nn_reads aligned:    824\nNumber of UMIs: 814\nMedian number of reads per UMI: 1.0\nNumber of genotypes: 123\n675 \n3   C56A\n3   A76G\n3   A91G\n3   A91T\n2   C69T\n2   T122A\n2   A91C\n2   A105G\n2   C116A\n2   T60A\n2   T59A\n2   A68G\n2   T134A\n1   A61G,-63T,A76T,A91T\n1   A79T,A91G\n1   A61G,A72G,A76G,A79T\n1   T108A,G127T,G132T\n1   A48T,A86G\n1   A61T,A68T,A72G,A79C,A91G",
    "crumbs": [
      "API",
      "genotypes"
    ]
  },
  {
    "objectID": "DGRec data analysis/mutation_distribution.html",
    "href": "DGRec data analysis/mutation_distribution.html",
    "title": "Mutations distribution",
    "section": "",
    "text": "We explore here the distribution of A, T, G or C mutated among the mutated molecules sequenced in a DGRec experiment.\nWe start from a list of genotypes and the number molecules found for each:\n\n\nCode\nfrom dgrec.utils import parse_genotypes, str_to_mut\nfrom dgrec.example_data import get_example_data_dir\nfrom Bio import SeqIO\nimport os\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n#Importing a list of genotypes with the number of molecules detected for each genotype\ndata_path=get_example_data_dir()\ngen_list=parse_genotypes(os.path.join(data_path,\"sacB_genotypes.csv\"))\n\ngen_list[0:50:5]\n\n\n[('', 42572),\n ('A76G', 112),\n ('T67G', 67),\n ('T90G', 41),\n ('A76G,A91G', 29),\n ('A72G,A79T', 22),\n ('A72G,A79G', 20),\n ('A111G', 17),\n ('A79T,A91T', 15),\n ('A79C,A91G', 13)]\n\n\nWe then plot how many of each base is found mutated among mutated molecules\n\n\nCode\n#converting genotype strings to lists\nmutations=[[str_to_mut(gen[0]),gen[1]] for gen in gen_list[1:]] \n\n#Counting the number genotypes with c bases mutated for each possible base\nbases=\"ATGC\"\nnN_mut=dict([(b,np.zeros(8)) for b in bases])\nfor g,n in mutations:\n    mutated_bases=np.array(list(zip(*g))[0])\n    for b in bases:\n        c=np.sum(mutated_bases==b) #number of mutated bases that are adenines\n        nN_mut[b][c]+=n\n\nfig, axes = plt.subplots(1,4,figsize=(16,4), sharey=True)\naxes[0].set_ylabel(\"number of molecules\")\nfor i,b in enumerate(bases):\n    axes[i].bar(range(8),nN_mut[b])\n    axes[i].set_title(b)\n    axes[i].set_xticks(range(8))\n    \n\n# Adjust layout\nplt.tight_layout()\nplt.show()",
    "crumbs": [
      "DGRec data analysis",
      "Mutations distribution"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "dgrec",
    "section": "",
    "text": "Read the doc: https://dbikard.github.io/dgrec/",
    "crumbs": [
      "dgrec"
    ]
  },
  {
    "objectID": "index.html#install",
    "href": "index.html#install",
    "title": "dgrec",
    "section": "Install",
    "text": "Install\npip install git+https://github.com/dbikard/dgrec.git",
    "crumbs": [
      "dgrec"
    ]
  },
  {
    "objectID": "index.html#how-to-use",
    "href": "index.html#how-to-use",
    "title": "dgrec",
    "section": "How to use",
    "text": "How to use\n\nCommand line interface\n\nSingle reads\ndgrec genotypes fastq_path reference_path -o genotypes.csv\n\n\nUsage: dgrec genotypes [OPTIONS] FASTQ REF\n\nOptions:\n  -u, --umi_size INTEGER          Number of nucleotides at the begining of the\n                                  read that will be used as the UMI\n  -q, --quality_threshold INTEGER\n                                  threshold value used to filter out reads of\n                                  poor average quality\n  -i, --ignore_pos LIST           list of positions that are ignored in the\n                                  genotype, e.g. [0,1,149,150]\n  -r, --reads_per_umi_thr INTEGER\n                                  minimum number of reads required to take a\n                                  UMI into account. Using a number &gt;2 enables\n                                  to perform error correction for UMIs with\n                                  multiple reads\n  -s, --save_umi_data TEXT        path to a csv file to save the details of\n                                  the genotypes reads for each UMI. If None\n                                  the data isn't saved.\n  -o, --output TEXT               output file path\n  --help                          Show this message and exit.\n\n\n\n\nPaired reads\ndgrec genotypes_paired fwd_fastq_path rev_fastq_path reference_path --fwd_span 0 150 --rev_span 30 150 -o genotypes.csv\n\n\nUsage: dgrec genotypes_paired [OPTIONS] FASTQ_FWD FASTQ_REV REF\n\n  Calls dgrec.genotypes_paired.get_genotypes_paired\n\nOptions:\n  --fwd_span &lt;INTEGER INTEGER&gt;...\n                                  Span of the reference sequence read in the\n                                  forward orientation format: start end\n                                  [required]\n  --rev_span &lt;INTEGER INTEGER&gt;...\n                                  Span of the reference sequence read in the\n                                  reverse orientation format: start end\n                                  [required]\n  -p, --require_perfect_pair_agreement\n                                  Require perfect pair agreement for genotype\n                                  calling (default: True).                  If\n                                  set to False, the forward sequence will be\n                                  used in case of disagreement.\n  -u1, --umi_size_fwd INTEGER     Number of nucleotides at the beginning of\n                                  the fwd read that will be used as the UMI\n                                  (default: 10)\n  -u2, --umi_size_rev INTEGER     Number of nucleotides at the beginning of\n                                  the rev read that will be used as the UMI\n                                  (default: 0)\n  -q, --quality_threshold INTEGER\n                                  Threshold value used to filter out reads of\n                                  poor average quality (default: 30)\n  -i, --ignore_pos LIST           List of positions that are ignored in the\n                                  genotype (default: [])\n  -r, --reads_per_umi_thr INTEGER\n                                  Minimum number of reads required to take a\n                                  UMI into account (default: 0).\n                                  Using a number &gt;2 enables to perform error\n                                  correction for UMIs with multiple reads\n  -s, --save_umi_data TEXT        Path to a csv file to save the details of\n                                  the genotypes reads for each UMI. If None\n                                  the data isn't saved (default: None)\n  -n INTEGER                      Number of reads to use. If None all the\n                                  reads are used (default: None)\n  -o, --output TEXT               Output file path\n  --help                          Show this message and exit.\n\n\n\n\n\nIn python\n\nimport dgrec\n\n\nfrom Bio import SeqIO\nimport os\n\n#Getting the path to the fastq file\nfastq_file=\"sacB_example.fastq.gz\"\nfastq_path=os.path.join(data_path,fastq_file)\n\n#Getting the reference sequence for the amplicon\nread_ref_file=\"sacB_ref.fasta\"\nref=next(SeqIO.parse(os.path.join(data_path,read_ref_file),\"fasta\"))\nref_seq=str(ref.seq)\n\n#Generating a list of genotypes sorted by the number of UMIs that are read for each genotype\ngen_list = dgrec.get_genotypes(fastq_path, ref_seq, ignore_pos=[0,1,2,138,139,140,141])\n\n#Printing the top results\nfor g in gen_list[:20]:\n    print(f\"{g[1]}\\t{g[0]}\")\n\nn reads:    1000\nn_reads pass filter:    847\nn_reads aligned:    824\nNumber of UMIs: 814\nMedian number of reads per UMI: 1.0\nNumber of genotypes: 123\n675 \n3   C56A\n3   A76G\n3   A91G\n3   A91T\n2   C69T\n2   T122A\n2   A91C\n2   A105G\n2   C116A\n2   T60A\n2   T59A\n2   A68G\n2   T134A\n1   A61G,-63T,A76T,A91T\n1   A79T,A91G\n1   A61G,A72G,A76G,A79T\n1   T108A,G127T,G132T\n1   A48T,A86G\n1   A61T,A68T,A72G,A79C,A91G\n\n\n\nfig = dgrec.plot_mutations(gen_list, ref_seq, sample_name=\"sacB\", TR_range=[50,119])",
    "crumbs": [
      "dgrec"
    ]
  },
  {
    "objectID": "API/predictions.html",
    "href": "API/predictions.html",
    "title": "predictions",
    "section": "",
    "text": "source\n\nscore\n\ndef score(\n    TR_seq:str, # A string of the TR DNA sequence\n    features:int=1, # The classifier model, no need to specify it (one feature by default). If two: uses the two features model\n):\n\nCalculates the predicted score of a given TR sequence (1 = perfect TR and 0 = crappy TR). If features=2, returns the score according to each feature (better to have both high).\n\nTR_bad='TTAGCGAATGGCGAAATTCGTAAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGTGGG'\nprint('TR bad score =',score(TR_bad))\nTR_good='AAATGATCGCCAAATCTGAACAGGAAATTGGCAAAGCAACCGCTAAATACTTTTTCTACTCAAACATTAT'\nprint('TR good score =',score(TR_good))\n\nTR bad score = 0.23\nTR good score = 0.84\n\n\n\nsource\n\n\nscore_list\n\ndef score_list(\n    TR_seq_list:list, # A list of strings of TRs DNA sequences\n    TR_name_list:list, # A list of strings of TRs names\n    features:int=1, # The number of features to use\n):\n\nCalculates the score for every TR in the list and returns them in a dataframe format. If features=2, returns the score according to each feature (better to have both high).\n\nTR_bad=[\n     'TTAGCGAATGGCGAAATTCGTAAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGTGGG',\n     'AAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGTGGGACAAAGGTCGTGATTTCGCTA',\n    'GGTTTCTCTAAGGAGTCCATTCTGCCGAAGCGCAACTCCGACAAGCTGATCGCGCGTAAGAAGGACTGGG',\n     'CAAGCTGATCGCGCGTAAGAAGGACTGGGATCCGAAGAAGTACGGTGGCTTCGATTCTCCGACCGTGGCG',\n     'ACCCGATTGACTTCCTCGAGGCGAAGGGGTACAAGGAGGTGAAGAAGGATCTGATTATCAAGCTGCCGAA',\n     'AGTACTCCCTGTTCGAGCTGGAGAATGGTCGTAAGCGTATGCTGGCGTCTGCGGGTGAGCTGCAGAAGGG',\n     'CAGCACAAGCACTACCTGGACGAGATTATTGAGCAGATTTCTGAGTTTTCTAAGCGCGTGATTCTGGCGG',\n     'ACGCGAATCTGGATAAGGTCCTGTCTGCCTACAATAAGCACCGTGATAAGCCGATCCGTGAGCAGGCGGA',   \n ]\n\nscore_list(TR_bad,['TR_bad_'+str(k) for k in range (1,9)])\n\n\n\n\n\n\n\n\nTR_Name\nTR_Seq\nTR_Score\n\n\n\n\n0\nTR_bad_1\nTTAGCGAATGGCGAAATTCGTAAACGCCCTCTGATCGAAACCAACG...\n0.23\n\n\n1\nTR_bad_2\nAAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGT...\n0.05\n\n\n2\nTR_bad_3\nGGTTTCTCTAAGGAGTCCATTCTGCCGAAGCGCAACTCCGACAAGC...\n0.00\n\n\n3\nTR_bad_4\nCAAGCTGATCGCGCGTAAGAAGGACTGGGATCCGAAGAAGTACGGT...\n0.00\n\n\n4\nTR_bad_5\nACCCGATTGACTTCCTCGAGGCGAAGGGGTACAAGGAGGTGAAGAA...\n0.01\n\n\n5\nTR_bad_6\nAGTACTCCCTGTTCGAGCTGGAGAATGGTCGTAAGCGTATGCTGGC...\n0.08\n\n\n6\nTR_bad_7\nCAGCACAAGCACTACCTGGACGAGATTATTGAGCAGATTTCTGAGT...\n0.06\n\n\n7\nTR_bad_8\nACGCGAATCTGGATAAGGTCCTGTCTGCCTACAATAAGCACCGTGA...\n0.12\n\n\n\n\n\n\n\n\nTR_good=[\n     'AAATGATCGCCAAATCTGAACAGGAAATTGGCAAAGCAACCGCTAAATACTTTTTCTACTCAAACATTAT',\n     'TCAAACATTATGAATTTCTTCAAAACCGAAATCACCTTAGCGAATGGCGAAATTCGTAAACGCCCTCTGA',\n     'ATGCCTCAAGTAAACATCGTTAAAAAGACTGAGGTGCAGACTGGCGGTTTCTCTAAGGAGTCCATTCTGC',\n     'GGATCCGAAGAAGTACGGTGGCTTCGATTCTCCGACCGTGGCGTACTCTGTTCTGGTGGTCGCCAAGGTC',\n     'AGCGTATGCTGGCGTCTGCGGGTGAGCTGCAGAAGGGGAACGAGTTGGCCCTTCCGTCCAAGTACGTGAA',\n     'GCAGAAGGGGAACGAGTTGGCCCTTCCGTCCAAGTACGTGAACTTCCTGTACCTGGCCTCGCACTACGAG',\n     'CAGAAGCAGCTGTTCGTGGAGCAGCACAAGCACTACCTGGACGAGATTATTGAGCAGATTTCTGAGTTTT',\n     'CTAAGCGCGTGATTCTGGCGGACGCGAATCTGGATAAGGTCCTGTCTGCCTACAATAAGCACCGTGATAA'\n     ]\n\nscore_list(TR_good,['TR_good_'+str(k) for k in range (1,9)])\n\n\n\n\n\n\n\n\nTR_Name\nTR_Seq\nTR_Score\n\n\n\n\n0\nTR_good_1\nAAATGATCGCCAAATCTGAACAGGAAATTGGCAAAGCAACCGCTAA...\n0.84\n\n\n1\nTR_good_2\nTCAAACATTATGAATTTCTTCAAAACCGAAATCACCTTAGCGAATG...\n0.82\n\n\n2\nTR_good_3\nATGCCTCAAGTAAACATCGTTAAAAAGACTGAGGTGCAGACTGGCG...\n0.76\n\n\n3\nTR_good_4\nGGATCCGAAGAAGTACGGTGGCTTCGATTCTCCGACCGTGGCGTAC...\n0.74\n\n\n4\nTR_good_5\nAGCGTATGCTGGCGTCTGCGGGTGAGCTGCAGAAGGGGAACGAGTT...\n0.83\n\n\n5\nTR_good_6\nGCAGAAGGGGAACGAGTTGGCCCTTCCGTCCAAGTACGTGAACTTC...\n0.55\n\n\n6\nTR_good_7\nCAGAAGCAGCTGTTCGTGGAGCAGCACAAGCACTACCTGGACGAGA...\n0.81\n\n\n7\nTR_good_8\nCTAAGCGCGTGATTCTGGCGGACGCGAATCTGGATAAGGTCCTGTC...\n0.81\n\n\n\n\n\n\n\n\nTR_bad=[\n     'TTAGCGAATGGCGAAATTCGTAAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGTGGG',\n     'AAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGTGGGACAAAGGTCGTGATTTCGCTA',\n    'GGTTTCTCTAAGGAGTCCATTCTGCCGAAGCGCAACTCCGACAAGCTGATCGCGCGTAAGAAGGACTGGG',\n     'CAAGCTGATCGCGCGTAAGAAGGACTGGGATCCGAAGAAGTACGGTGGCTTCGATTCTCCGACCGTGGCG',\n     'ACCCGATTGACTTCCTCGAGGCGAAGGGGTACAAGGAGGTGAAGAAGGATCTGATTATCAAGCTGCCGAA',\n     'AGTACTCCCTGTTCGAGCTGGAGAATGGTCGTAAGCGTATGCTGGCGTCTGCGGGTGAGCTGCAGAAGGG',\n     'CAGCACAAGCACTACCTGGACGAGATTATTGAGCAGATTTCTGAGTTTTCTAAGCGCGTGATTCTGGCGG',\n     'ACGCGAATCTGGATAAGGTCCTGTCTGCCTACAATAAGCACCGTGATAAGCCGATCCGTGAGCAGGCGGA',   \n ]\n\nscore_list(TR_bad,['TR_bad_'+str(k) for k in range (1,9)],2)\n\n\n\n\n\n\n\n\nTR_Name\nTR_Seq\nTR_Score_Sp\nTR_Score_Avd\n\n\n\n\n0\nTR_bad_1\nTTAGCGAATGGCGAAATTCGTAAACGCCCTCTGATCGAAACCAACG...\n0.23\n0.63\n\n\n1\nTR_bad_2\nAAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGT...\n0.05\n0.42\n\n\n2\nTR_bad_3\nGGTTTCTCTAAGGAGTCCATTCTGCCGAAGCGCAACTCCGACAAGC...\n0.00\n0.30\n\n\n3\nTR_bad_4\nCAAGCTGATCGCGCGTAAGAAGGACTGGGATCCGAAGAAGTACGGT...\n0.00\n0.51\n\n\n4\nTR_bad_5\nACCCGATTGACTTCCTCGAGGCGAAGGGGTACAAGGAGGTGAAGAA...\n0.01\n0.59\n\n\n5\nTR_bad_6\nAGTACTCCCTGTTCGAGCTGGAGAATGGTCGTAAGCGTATGCTGGC...\n0.08\n0.54\n\n\n6\nTR_bad_7\nCAGCACAAGCACTACCTGGACGAGATTATTGAGCAGATTTCTGAGT...\n0.06\n0.29\n\n\n7\nTR_bad_8\nACGCGAATCTGGATAAGGTCCTGTCTGCCTACAATAAGCACCGTGA...\n0.12\n0.04\n\n\n\n\n\n\n\n\nTR_good=[\n     'AAATGATCGCCAAATCTGAACAGGAAATTGGCAAAGCAACCGCTAAATACTTTTTCTACTCAAACATTAT',\n     'TCAAACATTATGAATTTCTTCAAAACCGAAATCACCTTAGCGAATGGCGAAATTCGTAAACGCCCTCTGA',\n     'ATGCCTCAAGTAAACATCGTTAAAAAGACTGAGGTGCAGACTGGCGGTTTCTCTAAGGAGTCCATTCTGC',\n     'GGATCCGAAGAAGTACGGTGGCTTCGATTCTCCGACCGTGGCGTACTCTGTTCTGGTGGTCGCCAAGGTC',\n     'AGCGTATGCTGGCGTCTGCGGGTGAGCTGCAGAAGGGGAACGAGTTGGCCCTTCCGTCCAAGTACGTGAA',\n     'GCAGAAGGGGAACGAGTTGGCCCTTCCGTCCAAGTACGTGAACTTCCTGTACCTGGCCTCGCACTACGAG',\n     'CAGAAGCAGCTGTTCGTGGAGCAGCACAAGCACTACCTGGACGAGATTATTGAGCAGATTTCTGAGTTTT',\n     'CTAAGCGCGTGATTCTGGCGGACGCGAATCTGGATAAGGTCCTGTCTGCCTACAATAAGCACCGTGATAA'\n     ]\n\nscore_list(TR_good,['TR_good_'+str(k) for k in range (1,9)],2)\n\n\n\n\n\n\n\n\nTR_Name\nTR_Seq\nTR_Score_Sp\nTR_Score_Avd\n\n\n\n\n0\nTR_good_1\nAAATGATCGCCAAATCTGAACAGGAAATTGGCAAAGCAACCGCTAA...\n0.84\n0.80\n\n\n1\nTR_good_2\nTCAAACATTATGAATTTCTTCAAAACCGAAATCACCTTAGCGAATG...\n0.82\n0.78\n\n\n2\nTR_good_3\nATGCCTCAAGTAAACATCGTTAAAAAGACTGAGGTGCAGACTGGCG...\n0.76\n0.84\n\n\n3\nTR_good_4\nGGATCCGAAGAAGTACGGTGGCTTCGATTCTCCGACCGTGGCGTAC...\n0.74\n0.75\n\n\n4\nTR_good_5\nAGCGTATGCTGGCGTCTGCGGGTGAGCTGCAGAAGGGGAACGAGTT...\n0.83\n0.88\n\n\n5\nTR_good_6\nGCAGAAGGGGAACGAGTTGGCCCTTCCGTCCAAGTACGTGAACTTC...\n0.55\n0.58\n\n\n6\nTR_good_7\nCAGAAGCAGCTGTTCGTGGAGCAGCACAAGCACTACCTGGACGAGA...\n0.81\n0.34\n\n\n7\nTR_good_8\nCTAAGCGCGTGATTCTGGCGGACGCGAATCTGGATAAGGTCCTGTC...\n0.81\n0.82\n\n\n\n\n\n\n\n\nsource\n\n\nDGR_percentage\n\ndef DGR_percentage(\n    TR_seq:str, # A string of the TR DNA sequence\n):\n\nCalculates the predicted DGR mutagenesis percentage of a given TR sequence (100 = perfect TR and 0 = crappy TR)\n\nsource\n\n\nDGR_percentage_list\n\ndef DGR_percentage_list(\n    TR_seq_list:list, # A list of strings of TRs DNA sequences\n    TR_name_list:list, # A list of strings of TRs names\n):\n\nCalculates the predicted DGR mutagenesis percentage for every TR in the list and returns them in a dataframe format\n\nTR_bad=[\n     'TTAGCGAATGGCGAAATTCGTAAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGTGGG',\n     'AAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGTGGGACAAAGGTCGTGATTTCGCTA',\n    'GGTTTCTCTAAGGAGTCCATTCTGCCGAAGCGCAACTCCGACAAGCTGATCGCGCGTAAGAAGGACTGGG',\n     'CAAGCTGATCGCGCGTAAGAAGGACTGGGATCCGAAGAAGTACGGTGGCTTCGATTCTCCGACCGTGGCG',\n     'ACCCGATTGACTTCCTCGAGGCGAAGGGGTACAAGGAGGTGAAGAAGGATCTGATTATCAAGCTGCCGAA',\n     'AGTACTCCCTGTTCGAGCTGGAGAATGGTCGTAAGCGTATGCTGGCGTCTGCGGGTGAGCTGCAGAAGGG',\n     'CAGCACAAGCACTACCTGGACGAGATTATTGAGCAGATTTCTGAGTTTTCTAAGCGCGTGATTCTGGCGG',\n     'ACGCGAATCTGGATAAGGTCCTGTCTGCCTACAATAAGCACCGTGATAAGCCGATCCGTGAGCAGGCGGA',   \n ]\n\nDGR_percentage_list(TR_bad,['TR_bad_'+str(k) for k in range (1,9)])\n\n\n\n\n\n\n\n\nTR_Name\nTR_Seq\nTR_rates\n\n\n\n\n0\nTR_bad_1\nTTAGCGAATGGCGAAATTCGTAAACGCCCTCTGATCGAAACCAACG...\n0.427049\n\n\n1\nTR_bad_2\nAAACGCCCTCTGATCGAAACCAACGGCGAAACGGGTGAGATCGTGT...\n0.110769\n\n\n2\nTR_bad_3\nGGTTTCTCTAAGGAGTCCATTCTGCCGAAGCGCAACTCCGACAAGC...\n0.019986\n\n\n3\nTR_bad_4\nCAAGCTGATCGCGCGTAAGAAGGACTGGGATCCGAAGAAGTACGGT...\n0.025612\n\n\n4\nTR_bad_5\nACCCGATTGACTTCCTCGAGGCGAAGGGGTACAAGGAGGTGAAGAA...\n0.045752\n\n\n5\nTR_bad_6\nAGTACTCCCTGTTCGAGCTGGAGAATGGTCGTAAGCGTATGCTGGC...\n0.172833\n\n\n6\nTR_bad_7\nCAGCACAAGCACTACCTGGACGAGATTATTGAGCAGATTTCTGAGT...\n0.092111\n\n\n7\nTR_bad_8\nACGCGAATCTGGATAAGGTCCTGTCTGCCTACAATAAGCACCGTGA...\n0.039965\n\n\n\n\n\n\n\n\nTR_good=[\n     'AAATGATCGCCAAATCTGAACAGGAAATTGGCAAAGCAACCGCTAAATACTTTTTCTACTCAAACATTAT',\n     'TCAAACATTATGAATTTCTTCAAAACCGAAATCACCTTAGCGAATGGCGAAATTCGTAAACGCCCTCTGA',\n     'ATGCCTCAAGTAAACATCGTTAAAAAGACTGAGGTGCAGACTGGCGGTTTCTCTAAGGAGTCCATTCTGC',\n     'GGATCCGAAGAAGTACGGTGGCTTCGATTCTCCGACCGTGGCGTACTCTGTTCTGGTGGTCGCCAAGGTC',\n     'AGCGTATGCTGGCGTCTGCGGGTGAGCTGCAGAAGGGGAACGAGTTGGCCCTTCCGTCCAAGTACGTGAA',\n     'GCAGAAGGGGAACGAGTTGGCCCTTCCGTCCAAGTACGTGAACTTCCTGTACCTGGCCTCGCACTACGAG',\n     'CAGAAGCAGCTGTTCGTGGAGCAGCACAAGCACTACCTGGACGAGATTATTGAGCAGATTTCTGAGTTTT',\n     'CTAAGCGCGTGATTCTGGCGGACGCGAATCTGGATAAGGTCCTGTCTGCCTACAATAAGCACCGTGATAA'\n     ]\n\nDGR_percentage_list(TR_good,['TR_good_'+str(k) for k in range (1,9)])\n\n\n\n\n\n\n\n\nTR_Name\nTR_Seq\nTR_rates\n\n\n\n\n0\nTR_good_1\nAAATGATCGCCAAATCTGAACAGGAAATTGGCAAAGCAACCGCTAA...\n3.067841\n\n\n1\nTR_good_2\nTCAAACATTATGAATTTCTTCAAAACCGAAATCACCTTAGCGAATG...\n2.721600\n\n\n2\nTR_good_3\nATGCCTCAAGTAAACATCGTTAAAAAGACTGAGGTGCAGACTGGCG...\n2.808427\n\n\n3\nTR_good_4\nGGATCCGAAGAAGTACGGTGGCTTCGATTCTCCGACCGTGGCGTAC...\n1.919474\n\n\n4\nTR_good_5\nAGCGTATGCTGGCGTCTGCGGGTGAGCTGCAGAAGGGGAACGAGTT...\n4.142115\n\n\n5\nTR_good_6\nGCAGAAGGGGAACGAGTTGGCCCTTCCGTCCAAGTACGTGAACTTC...\n0.811313\n\n\n6\nTR_good_7\nCAGAAGCAGCTGTTCGTGGAGCAGCACAAGCACTACCTGGACGAGA...\n0.940305\n\n\n7\nTR_good_8\nCTAAGCGCGTGATTCTGGCGGACGCGAATCTGGATAAGGTCCTGTC...\n3.040041\n\n\n\n\n\n\n\n\nsource\n\n\noptimize_sequence\n\ndef optimize_sequence(\n    original_seq:str, # Original DNA sequence to optimize.\n    frame_offset:int=0, # Reading-frame offset (0, 1, or 2) used when grouping codons.\n    CHANGES:int=6, # Maximum number of codon substitutions allowed.\n    freq_min:float=0.2, # Lowest usage frequency acceptable.\n    N:int=1, # Number of putative TR to output.\n    forbidden_positions:list=[], # Nucleotide positions that must not be modified.\n    threshold:float=0.7, # Minimum required value for both `Score_TRSp` and `Score_TRSpAvd` to\naccept a sequence as optimal.\n    codon_usage:dict={'F': {'TTT': 0.57, 'TTC': 0.43}, 'L': {'TTA': 0.15, 'TTG': 0.12, 'CTT': 0.12, 'CTC': 0.1, 'CTA': 0.05, 'CTG': 0.46}, 'S': {'TCT': 0.11, 'TCC': 0.11, 'TCA': 0.15, 'TCG': 0.16, 'AGT': 0.14, 'AGC': 0.33}, 'Y': {'TAT': 0.53, 'TAC': 0.47}, '*': {'TAA': 0.64, 'TAG': 0.0, 'TGA': 0.36}, 'C': {'TGT': 0.42, 'TGC': 0.58}, 'W': {'TGG': 1.0}, 'P': {'CCT': 0.17, 'CCC': 0.13, 'CCA': 0.14, 'CCG': 0.55}, 'H': {'CAT': 0.55, 'CAC': 0.45}, 'Q': {'CAA': 0.3, 'CAG': 0.7}, 'R': {'CGT': 0.36, 'CGC': 0.44, 'CGA': 0.07, 'CGG': 0.07, 'AGA': 0.07, 'AGG': 0.0}, 'I': {'ATT': 0.58, 'ATC': 0.35, 'ATA': 0.07}, 'M': {'ATG': 1.0}, 'T': {'ACT': 0.16, 'ACC': 0.47, 'ACA': 0.13, 'ACG': 0.24}, 'N': {'AAT': 0.47, 'AAC': 0.53}, 'K': {'AAA': 0.73, 'AAG': 0.27}, 'V': {'GTT': 0.25, 'GTC': 0.18, 'GTA': 0.17, 'GTG': 0.4}, 'A': {'GCT': 0.11, 'GCC': 0.31, 'GCA': 0.2, 'GCG': 0.38}, 'D': {'GAT': 0.65, 'GAC': 0.35}, 'E': {'GAA': 0.7, 'GAG': 0.3}, 'G': {'GGT': 0.29, 'GGC': 0.46, 'GGA': 0.13, 'GGG': 0.12}}, # Codon usage table of E. Coli mapping amino acids to codons and frequencies.\n): # Dictionary containing:\n- `Original_Sequence` : str  \n  Input DNA sequence.\n- `New_Variant` : str  \n  Optimized DNA sequence.\n- `Rank` : int or None  \n  rank of the sequence (by score).\n- `Score` : float or None  \n  score of the selected variant (geometrical mean).\n- `Score_TRSp` : float or None  \n  TR+Sp score of the selected variant.\n- `Score_TRSpAvd` : float or None  \n  Avd+TR+Sp score of the selected variant.\n\nOptimize a DNA sequence via synonymous codon substitutions.\nThis function performs a beam-search–based optimization of a nucleotide sequence by iteratively proposing single-codon synonymous changes and evaluating them with the two scoring functions. The search stops early if a variant meets the specified score thresholds, otherwise the best Pareto- optimal solution is returned.\n\nseq = ''.join(np.random.choice(['A','T','C','G'], size=70))\nprint(seq)\n\noptimize_sequence(seq,N=5,CHANGES=6)\n\nCCTGTATGTTTCCTTTCCCCAGAGAACTTGACGAGTTGGGTTTATAGGTAATTACTGCTGATAAATAAAA\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n[{'Original_Sequence': 'CCTGTATGTTTCCTTTCCCCAGAGAACTTGACGAGTTGGGTTTATAGGTAATTACTGCTGATAAATAAAA',\n  'New_Variant': 'CCGGTATGTTTCCTGTCCCCAGAGAACTTGACGAGTTGGGTTTATAGGTAATTACTGCTGATAAATAAAA',\n  'Score': 0.8270429251254133,\n  'Rank': 1,\n  'Score_TRSp': 0.9,\n  'Score_TRSpAvd': 0.76},\n {'Original_Sequence': 'CCTGTATGTTTCCTTTCCCCAGAGAACTTGACGAGTTGGGTTTATAGGTAATTACTGCTGATAAATAAAA',\n  'New_Variant': 'CCGGTATGTTTCCTTTCCCCAGAGAACTTGACGAGTTGGGTTTATAGGTAACTGCTGCTGATAAATAAAA',\n  'Score': 0.8224354077980836,\n  'Rank': 2,\n  'Score_TRSp': 0.89,\n  'Score_TRSpAvd': 0.76},\n {'Original_Sequence': 'CCTGTATGTTTCCTTTCCCCAGAGAACTTGACGAGTTGGGTTTATAGGTAATTACTGCTGATAAATAAAA',\n  'New_Variant': 'CCGGTATGTTTCCTTTCCCCAGAGAACTTGACGAGCTGGGTTTATAGGTAATTACTGCTGATAAATAAAA',\n  'Score': 0.8215838362577492,\n  'Rank': 3,\n  'Score_TRSp': 0.9,\n  'Score_TRSpAvd': 0.75},\n {'Original_Sequence': 'CCTGTATGTTTCCTTTCCCCAGAGAACTTGACGAGTTGGGTTTATAGGTAATTACTGCTGATAAATAAAA',\n  'New_Variant': 'CCGGTATGTTTCCTTTCCCCAGAGAACTTGACGAGTTGGGTGTATAGGTAATTACTGCTGATAAATAAAA',\n  'Score': 0.7949842765740717,\n  'Rank': 4,\n  'Score_TRSp': 0.79,\n  'Score_TRSpAvd': 0.8},\n {'Original_Sequence': 'CCTGTATGTTTCCTTTCCCCAGAGAACTTGACGAGTTGGGTTTATAGGTAATTACTGCTGATAAATAAAA',\n  'New_Variant': 'CCGGTATGTTTCCTTTCCCCAGAGAACTTGACGAGTTGGGTTTATAGGTAATTACTGCTGATTAATAAAA',\n  'Score': 0.7602631123499285,\n  'Rank': 5,\n  'Score_TRSp': 0.85,\n  'Score_TRSpAvd': 0.68}]",
    "crumbs": [
      "API",
      "predictions"
    ]
  },
  {
    "objectID": "API/utils.html",
    "href": "API/utils.html",
    "title": "utils",
    "section": "",
    "text": "source\n\nalign2mut\n\ndef align2mut(\n    align\n):\n\nConverts a sequence alignment result from Bio.pairwise2.Align.globalms into a list of mutations. Positions are those of the alignment.\n\nseqA = \"ATCCCGGCAGC\"\nseqB = \"ATCCACGGTCAGC\"\nalign=pairwise2.align.globalms(seqA,seqB, 2, -1, -1, -.5, one_alignment_only=True)[0]\nalign2mut(align)\n\n[('-', 4, 'A'), ('-', 8, 'T')]\n\n\n\nsource\n\n\nmut_rix\n\ndef mut_rix(\n    mutations\n):\n\nReindexes the positions of the mutations to go from  their position in the sequence alignment to their position in the original sequence.\n\nseqA = \"ATCCCGGCAGC\"\nseqB = \"ATCCACGGTCAGC\"\nalign=pairwise2.align.globalms(seqA,seqB, 2, -1, -1, -.5, one_alignment_only=True)[0]\nprint(format_alignment(*align))\n\nmutations=align2mut(align) \nprint(\"Output of align2mut:\")\nprint(mutations)\n\nprint(\"Output of mut_rix:\")\nprint(mut_rix(mutations))\n\nATCC-CGG-CAGC\n|||| ||| ||||\nATCCACGGTCAGC\n  Score=20\n\nOutput of align2mut:\n[('-', 4, 'A'), ('-', 8, 'T')]\nOutput of mut_rix:\n[('-', 4, 'A'), ('-', 7, 'T')]\n\n\n\nsource\n\n\nget_mutations\n\ndef get_mutations(\n    seqA, seqB, match:int=2, mismatch:int=-1, gap_open:int=-1, gap_extend:float=-0.5\n):\n\nAligns two sequences and returns a genotype string. The string is a comma separated list of mutations.\n\nseqA = \"ATCCGGCAGCAGGTCGTGAGC\"\nseqB = \"ATCCACGGTCAGCACGTCGTGGC\"\nalign=pairwise2.align.globalms(seqA,seqB, 2, -1, -1, -.5, one_alignment_only=True)[0]\nprint(format_alignment(*align))\n\nget_mutations(seqA,seqB)\n\nATC--CGG-CAGCAGGTCGTGAGC\n|||  ||| |||||.|||||| ||\nATCCACGGTCAGCACGTCGTG-GC\n  Score=33.5\n\n\n\n[('-', 3, 'C'), ('-', 3, 'A'), ('-', 6, 'T'), ('G', 11, 'C'), ('A', 18, '-')]\n\n\n\nsource\n\n\nget_mutations_noalign\n\ndef get_mutations_noalign(\n    seqA, seqB\n):\n\nReturns a genotype string. The string is a comma separated list of mutations.\n\nget_mutations_noalign(\"AGCTATGG\",\"AGCTCTGG\")\n\n[('A', '4', 'C')]\n\n\n\nsource\n\n\nmut_to_str\n\ndef mut_to_str(\n    mutations:list\n):\n\nConverts list of mutations to a comma separated string\n\nmut_to_str([('-', 3, 'C'), ('-', 3, 'A'), ('-', 6, 'T'), ('G', 11, 'C'), ('A', 18, '-')])\n\n'-3C,-3A,-6T,G11C,A18-'\n\n\n\nsource\n\n\nstr_to_mut\n\ndef str_to_mut(\n    gen:str\n):\n\nConverts genotype string to a list of mutations\n\nassert(str_to_mut('')==[])\nstr_to_mut('-4A,-7T,G12C')\n\n[['-', 4, 'A'], ['-', 7, 'T'], ['G', 12, 'C']]\n\n\n\nsource\n\n\ngenstr_to_seq\n\ndef genstr_to_seq(\n    genstr, refseq\n):\n\n\ngenstr='-3C,-3A,-6T,G11C,A18-'\ngenstr_to_seq(genstr,seqA)\n\n'ATCCACGGTCAGCACGTCGTGGC'\n\n\n\ns=\"AGCGAGC\"\nprint(len(s)%3)\ns[:-(len(s)%3)]\n\n1\n\n\n'AGCGAG'\n\n\n\nsource\n\n\nreverse_complement\n\ndef reverse_complement(\n    dna\n):\n\n\nsource\n\n\nget_prot_mut\n\ndef get_prot_mut(\n    genstr, refseq, frame:int=0, ori:int=1\n):\n\n\nseqA = \"AGCGCTATGCTGCGCGCGTACTGCCGCTAGCTATGCTCAGGCCGATATATGCGAGCA\"\nseqB = \"AGCGCTATGCTGCGCGCGAAAACCCGCTAGCTATGCTCAGGTCGATATATGCGAGCA\"\ngenstr=mut_to_str(get_mutations(seqA,seqB,gap_open=-5))\nprint(genstr)\nget_prot_mut(genstr,seqA,frame=1)\n\nT18A,C20A,T21A,G22C,C41T\n\n\n'T6K,A7P,A13V'\n\n\n\ngenstr='A61G,-63T,A79T'\nrefseq='CGCCTTGGTAGCCATCTTCAGTTCCAGTGTTTGCTTCAAATACTAAGTATTTGTGGCCTTTATCTTCTACGTAGTGAGGATCTCTCAGCGTATGGTTGTCGCCTGAGCTGTAGTTGCCTTCATCGATGAACTGCTGTAC'\nori=-1\nframe=0\nget_prot_mut(genstr,refseq,frame=frame,ori=ori)\n\n'D19E,D25E,K26Q,G27R,H28P,K29Q,Y30I,V32S,F33I,E34*,A35S,N36K,T37H,G38W,T39N,E40*,D41R,G42W,Y43L,Q44P,G45R'\n\n\n\ngenstr='A61G,A79T'\nrefseq='CGCCTTGGTAGCCATCTTCAGTTCCAGTGTTTGCTTCAAATACTAAGTATTTGTGGCCTTTATCTTCTACGTAGTGAGGATCTCTCAGCGTATGGTTGTCGCCTGAGCTGTAGTTGCCTTCATCGATGAACTGCTGTAC'\nori=-1\nframe=0\nget_prot_mut(genstr,refseq,frame=frame,ori=ori)\n\n'D19E'\n\n\n\nsource\n\n\nparse_genotypes\n\ndef parse_genotypes(\n    genotypes_file\n):\n\n\nfrom dgrec.example_data import get_example_data_dir\n\n\ndata_path=get_example_data_dir()\ngen_list=parse_genotypes(os.path.join(data_path,\"sacB_genotypes.csv\"))\nfor g,n in itertools.islice(gen_list,30,40):\n    print(n,\"\\t\",g)\n\n20   A72G,A79G\n19   A72G,A79T,A91G\n17   T67G,A91G\n17   A76G,A79T\n17   A68C,A72G\n17   A111G\n16   A68G,A91G\n16   A86G,A91T\n15   A72G,A91T\n15   A79G,A86G\n\n\n\nsource\n\n\nget_aa_mut_list\n\ndef get_aa_mut_list(\n    gen_list, refseq, frame:int=0, ori:int=1\n):\n\n\nread_ref_file=\"sacB_ref.fasta\"\nrefseq=next(SeqIO.parse(os.path.join(data_path,read_ref_file),\"fasta\"))\nrefseq=str(refseq.seq)\naa_mut_list=get_aa_mut_list(gen_list,refseq,ori=-1)\naa_mut_list[:10]\n\n[('', 43341),\n ('Y22H', 351),\n ('H15Q', 277),\n ('D19E', 246),\n ('L17P', 200),\n ('V23A', 162),\n ('S11P', 117),\n ('D25E', 113),\n ('D19E,Y22H', 75),\n ('T16P', 61)]\n\n\n\nsource\n\n\ndownsample_fastq_gz\n\ndef downsample_fastq_gz(\n    input_file, output_file, num_reads:int=10000\n):\n\nDownsamples a compressed FASTQ file to the specified number of reads.\nArgs: input_file (str): Path to the input FASTQ.gz file. output_file (str): Path to the output FASTQ.gz file. num_reads (int, optional): Number of reads to keep. Defaults to 10000.\n\ninput_file=os.path.join(data_path,\"sacB_example.fastq.gz\")\noutput_file=\"sacB_example_downsampled.fastq.gz\"\ndownsample_fastq_gz(input_file, output_file, num_reads=100)\n\n\nsource\n\n\nget_basename_without_extension\n\ndef get_basename_without_extension(\n    file_path\n):\n\nExtracts the basename of a file without the extension.\nArgs: file_path (str): The path to the file.\nReturns: str: The basename of the file without the extension.\n\n# Example usage\nfile_path = \"C:/Users/John/Documents/my_file.txt\"\nbasename_without_extension = get_basename_without_extension(file_path)\nprint(basename_without_extension)  # Output: my_file\n\nmy_file\n\n\n\nsource\n\n\npickle_save\n\ndef pickle_save(\n    data_in, file_name_out\n):\n\n\nsource\n\n\npickle_load\n\ndef pickle_load(\n    file_name_in\n):\n\n\nsource\n\n\nmake_dgr_oligos\n\ndef make_dgr_oligos(\n    target:str, # TR DNA\n    split_number:int, # Number of desired splits\n):\n\nSplit the TR target into the input number and then generates the oligos to order\n\ntarget='CCTCAGATACAAGCCGGCATAAATAATAACATATTCTATGACCATGATAATAGTGTAGGTGCAAACGCCAACGCTAAAAACACTGGAACCATGAACGGTAATACTGCAGGGACGAATATAGCCAAAACTTCT'\nmake_dgr_oligos(target,4)\n\n['ATAACCTCAGATACAAGCCGGCATAAATAATAACA',\n 'AATATGTTATTATTTATGCCGGCTTGTATCTGAGG',\n 'TATTCTATGACCATGATAATAGTGTAGGTGCAA',\n 'GCGTTTGCACCTACACTATTATCATGGTCATAG',\n 'ACGCCAACGCTAAAAACACTGGAACCATGAACG',\n 'TTACCGTTCATGGTTCCAGTGTTTTTAGCGTTG',\n 'GTAATACTGCAGGGACGAATATAGCCAAAACTTCT',\n 'CAGAAGAAGTTTTGGCTATATTCGTCCCTGCAGTA']\n\n\n\nsource\n\n\nreverse_comp_geno_list\n\ndef reverse_comp_geno_list(\n    geno_list:list, # List of genotypes\n    ref_seq:str, # string of the template sequence\n):\n\n\nsource\n\n\nremove_position\n\ndef remove_position(\n    geno, pos_list\n):\n\n\nsource\n\n\nremove_position_list\n\ndef remove_position_list(\n    geno_list, pos_list\n):\n\n\nref_genome='AACGTATACGGCGGAATATTTGCCGAATGCCGTGTGGACGTAAGCGTGAACGTCAGGATCACGTTTCCCCGACCCGCTGGCATGTCAACAATACGGGAGAACACCTGTACCGCCTCGTTCGCCGCGC'\ngeno_list_test=[('T19C', 176012),\n ('T19C,T64A,T65A', 169),\n ('T19C,G36T', 40),\n ('T19C,T58G,T63A,T64G', 4),\n ('T19C,A42C', 14),\n ('T19C,T63G', 13),\n ('T19C,T52A,T64A,T65A', 19),\n ('T19C,A41C,A57C,T58C', 1),\n ('T19C,T52A', 94),\n ('T19C,T64A,T65G', 214),\n ('T19C,T63A,T64C,T65A', 2),\n ('T19C,A49C,T64C,T91C', 2),\n ('T19C,T32C,T52C,T64A,T65G,T84C,T91A', 1),\n ('T19C,T82C,T84A', 8),\n ('T19C,T64C', 308),\n ('T19C,T40C,G43A,T58A,A71C,T91C', 1),\n ('T52A,T77C', 1),\n ('T19C,T52C,T58A', 9),\n ('T20C,-52C,T58C,A71C,T77C', 1),\n ('T19C,G70T', 110),\n ('T19C,T32C,T65C,T82C', 1),\n ('T19C,T32C,T46C', 4),\n ('T19C,T32C,A41C,A49C,T64A,T65G', 1),\n ('T19C,T64A', 115),\n ('T19C,T58C', 68)]\n\ngeno_list_test=remove_position_list(geno_list_test,[19])\nreverse_comp_geno_list(geno_list_test,ref_genome)\n\n[('', 176012),\n ('A61T,A62T', 169),\n ('C90A', 40),\n ('A62C,A63T,A68C', 4),\n ('T84G', 14),\n ('A63C', 13),\n ('A61T,A62T,A74T', 19),\n ('A68G,T69G,T85G', 1),\n ('A74T', 94),\n ('A61C,A62T', 214),\n ('A61T,A62G,A63T', 2),\n ('A35G,A62G,T77G', 2),\n ('A35T,A42G,A61C,A62T,A74G,A94G', 1),\n ('A42T,A44G', 8),\n ('A62G', 308),\n ('A35G,T55G,A68T,C83T,A86G', 1),\n ('A49G,A74T', 1),\n ('A68T,A74G', 9),\n ('A49G,T55G,A68G,-74G,A106G', 1),\n ('C56A', 110),\n ('A44G,A61G,A94G', 1),\n ('A80G,A94G', 4),\n ('A61C,A62T,T77G,T85G,A94G', 1),\n ('A62T', 115),\n ('A68G', 68)]",
    "crumbs": [
      "API",
      "utils"
    ]
  },
  {
    "objectID": "API/genotypes_paired.html",
    "href": "API/genotypes_paired.html",
    "title": "genotypes_paired",
    "section": "",
    "text": "source\n\nget_UMI_genotype_paired\n\ndef get_UMI_genotype_paired(\n    fastq_path_fwd:str, # path to the input fastq file reading the ref_seq in the forward orientation\n    fastq_path_rev:str, # path to the input fastq file reading the ref_seq in the reverse orientation\n    ref_seq:str, # sequence of the reference amplicon\n    fwd_span:tuple, # span of the ref_seq that is read in the forward orientation format: (start, end)\n    rev_span:tuple, # span of the ref_seq that is read in the reverse orientation format: (start, end)\n    fwd_ref_read_size:int=None, # number of nucleotides in the fwd read expected to align to the ref_seq. If None the whole read will be used.\n    rev_ref_read_size:int=None, # number of nucleotides in the rev read expected to align to the ref_seq. If None the whole read will be used.\n    require_perfect_pair_agreement:bool=True, # if True only pairs of reads that perfectly agree on the sequence within the common span will be used. If False the fwd sequence will be used. Will be set to False by default if there is no overlap.\n    umi_size_fwd:int=10, # number of nucleotides at the begining of the fwd read that will be used as the UMI\n    umi_size_rev:int=0, # number of nucleotides at the begining of the rev read that will be used as the UMI (if both are provided the umi will be the concatenation of both)\n    quality_threshold:int=30, # threshold value used to filter out reads of poor average quality. Both reads have to pass the threshold.\n    ignore_pos:list=[], # list of positions that are ignored in the genotype\n    N:NoneType=None, # number of reads to consider (useful to get a quick view of the data without going through the whole fastq files). If None the whole data will be used.\n    kwargs:VAR_KEYWORD\n)-&gt;dict: # alignment parameters can be passed here (match, mismatch, gap_open, gap_extend)\n\n\nfastq_path_fwd=os.path.join(data_path,\"paired_example1_R2.fastq.gz\")\nfastq_path_rev=os.path.join(data_path,\"paired_example1_R1.fastq.gz\")\n\n\nread_ref_file=\"sacB_ref.fasta\"\nref=next(SeqIO.parse(os.path.join(data_path,read_ref_file),\"fasta\"))\nref_seq=\"GAGGAGACGGTGACCTGGGTCCCCTGGCCCCAGTTGTTGAAGTCATACCCTTAGGCACCATAGTATCCAGACGCACAGTAGTACAAGGCAGTGTCCTCAGGTTTCAGGCTGTTCATTTGCAGATACACCGTGTTCTTGGCGTTGTCTTGGG\"\n\nUMI_gencounter = get_UMI_genotype_paired(fastq_path_fwd, \n                                         fastq_path_rev, \n                                         ref_seq, \n                                         fwd_span=(0,150), \n                                         rev_span=(0,0),\n                                         umi_size_fwd=0,\n                                         umi_size_rev=10,\n                                         N=10,\n                                         ignore_pos=[0,1,2,150,151])\n\nfor umi in itertools.islice(UMI_gencounter,20):\n    print(umi, list(UMI_gencounter[umi].items()))\n\nn reads:    10\nn_reads pass filter:    10\nn_reads aligned:    10\nn_pairs agree:  0\nNumber of UMIs: 10\nMedian number of reads per UMI: 1.0\nGGACGCGATA [('T50A,T51G', 1)]\nGCTGTATGTT [('T50A,T51G', 1)]\nGGGAAGGCGT [('', 1)]\nGGCGACAGTG [('', 1)]\nCCATGTCGGG [('', 1)]\nCNGATGTTTG [('T33G,T34A,T51G', 1)]\nGTCACACCAC [('T33C,T34C,T36C,T50A', 1)]\nCCAGACTGTT [('', 1)]\nCAGGGTTTAT [('T50A,T51G', 1)]\nATGGGTACGG [('T130A', 1)]\n\n\n\nsource\n\n\nget_genotypes_paired\n\ndef get_genotypes_paired(\n    fastq_path_fwd:str, # path to the input fastq file reading the ref_seq in the forward orientation\n    fastq_path_rev:str, # path to the input fastq file reading the ref_seq in the reverse orientation\n    ref_seq:str, # sequence of the reference amplicon\n    fwd_span:tuple, # span of the ref_seq that is read in the forward orientation format: (start, end)\n    rev_span:tuple, # span of the ref_seq that is read in the reverse orientation format: (start, end)\n    fwd_ref_read_size:int=None, # number of nucleotides in the fwd read expected to align to the ref_seq. If None the whole read will be used.\n    rev_ref_read_size:int=None, # number of nucleotides in the rev read expected to align to the ref_seq. If None the whole read will be used.\n    require_perfect_pair_agreement:bool=True, # if True only pairs of reads that perfectly agree on the sequence within the common span will be used. If False the fwd sequence will be used. Will be set to False by default if there is no overlap.\n    umi_size_fwd:int=10, # number of nucleotides at the begining of the fwd read that will be used as the UMI\n    umi_size_rev:int=0, # number of nucleotides at the begining of the rev read that will be used as the UMI (if both are provided the umi will be the concatenation of both)\n    quality_threshold:int=30, # threshold value used to filter out reads of poor average quality\n    ignore_pos:list=[], # list of positions that are ignored in the genotype\n    reads_per_umi_thr:int=0, # minimum number of reads required to take a UMI into account. Using a number &gt;2 enables to perform error correction for UMIs with multiple reads.\n    save_umi_data:str=None, # path to the csv file where to save the details of the genotypes reads for each UMI. If None the data isn't saved.\n    N:NoneType=None, # number of reads to consider (useful to get a quick view of the data without going through the whole fastq files). If None the whole data will be used.\n    kwargs:VAR_KEYWORD\n):\n\nPutting things together in a single wrapper function that takes the fastq as input and returns the list of genotypes.\n\ngen_list = get_genotypes_paired(fastq_path_fwd, \n                        fastq_path_rev, \n                        ref_seq, \n                        fwd_span=(0,150), \n                        rev_span=(0,0),\n                        umi_size_fwd=0,\n                        umi_size_rev=10,\n                        ignore_pos=[0,1,150,151],\n                        N=100,\n                        save_umi_data=\"test.csv\")\nfor g in gen_list[:20]:\n    print(f\"{g[1]}\\t{g[0]}\")\n\nn reads:    100\nn_reads pass filter:    96\nn_reads aligned:    94\nn_pairs agree:  0\nNumber of UMIs: 85\nMedian number of reads per UMI: 1.0\nNumber of genotypes: 12\n49  \n23  T50A,T51G\n2   T33G,T34A,T51G\n2   T33C,T34C,T36C,T50A\n2   T37C,T42C,T45A,T50C,T51C\n1   T130A\n1   A52C\n1   G8A\n1   T51C\n1   A52C,G131C\n1   G69A\n1   T37C,T42C,T45A,T50C,T51C,T146A",
    "crumbs": [
      "API",
      "genotypes_paired"
    ]
  },
  {
    "objectID": "API/analysis.html",
    "href": "API/analysis.html",
    "title": "analysis",
    "section": "",
    "text": "from dgrec.example_data import get_example_data_dir\n\n\nsource\n\nmut_rate\n\ndef mut_rate(\n    gen_list:list, # a genotype list with the number of molecules detected\n    ran:tuple, # the position range in which to compute the mutation rate. If None the rate is computed for the full sequence.\n    ref_seq:str, # reference sequence\n):\n\nComputes the mutation rate per base within the specified range. The rate can be computed for specific bases using the base_restriction argument.\n\ndata_path=get_example_data_dir()\ngen_list=parse_genotypes(os.path.join(data_path,\"sacB_genotypes.csv\"))\n\nread_ref_file=\"sacB_ref.fasta\"\nref=next(SeqIO.parse(os.path.join(data_path,read_ref_file),\"fasta\"))\nref_seq=str(ref.seq)\n\n#showing a few example lines\nfor g,n in gen_list[1:200:20]:\n    print(n,\"\\t\",g)\n\n279      A91G\n28   A68C\n15   A72G,A79T,A91T\n10   A61G,A72G\n6    A61G,A68G\n6    A68G,A76G,A91G\n5    A61T,A79G\n4    A86T\n4    A72G,A76G,A86G,A91T\n3    A61T,A76G,A91G\n\n\n\nTR_range=(50,119)\nbefore_TR_range=(5,50)\nmut_rate_TR=mut_rate(gen_list,TR_range,ref_seq)\nfor b in mut_rate_TR:\n    print(f\"Mutation rate in VR at {b} positions: {mut_rate_TR[b]:.1e}\")\n\nmut_rate_outside_TR=mut_rate(gen_list,before_TR_range,ref_seq)\nfor b in mut_rate_outside_TR:\n    print(f\"Mutation rate outside VR at {b} positions: {mut_rate_outside_TR[b]:.1e}\")\n\nMutation rate in VR at A positions: 1.9e-02\nMutation rate in VR at T positions: 9.9e-04\nMutation rate in VR at G positions: 1.1e-04\nMutation rate in VR at C positions: 2.2e-04\nMutation rate in VR at all positions: 2.9e-03\nMutation rate outside VR at A positions: 2.1e-05\nMutation rate outside VR at T positions: 4.8e-05\nMutation rate outside VR at G positions: 1.8e-04\nMutation rate outside VR at C positions: 5.9e-05\nMutation rate outside VR at all positions: 6.7e-05",
    "crumbs": [
      "API",
      "analysis"
    ]
  }
]